[{"filePath":"/Users/mac/Desktop/akouass/note/site de publising/site 1 /eslint.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/mac/Desktop/akouass/note/site de publising/site 1 /src/App.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/mac/Desktop/akouass/note/site de publising/site 1 /src/components/LanguageSwitcher.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/mac/Desktop/akouass/note/site de publising/site 1 /src/components/ProfileCompletionCard.jsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'checkProfileCompletion'. Either include it or remove the dependency array.","line":15,"column":8,"nodeType":"ArrayExpression","endLine":15,"endColumn":14,"suggestions":[{"desc":"Update the dependencies array to be: [checkProfileCompletion, user]","fix":{"range":[527,533],"text":"[checkProfileCompletion, user]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { useAuth } from '../contexts/AuthContext';\nimport { supabase } from '../supabaseClient';\nimport { User, AlertCircle } from 'lucide-react';\n\nconst ProfileCompletionCard = () => {\n    const { user } = useAuth();\n    const navigate = useNavigate();\n    const [completion, setCompletion] = useState(null);\n    const [loading, setLoading] = useState(true);\n\n    useEffect(() => {\n        if (user) checkProfileCompletion();\n    }, [user]);\n\n    const checkProfileCompletion = async () => {\n        try {\n            const { data: profile, error } = await supabase\n                .from('profiles')\n                .select('*')\n                .eq('id', user.id)\n                .single();\n\n            if (error) throw error;\n\n            // Define required fields for profile completion\n            const requiredFields = [\n                'full_name',\n                'birth_date',\n                'birth_place',\n                'nationality',\n                'id_card_number',\n                'id_card_type',\n                'address',\n                'phone',\n                'profession',\n                'professional_status',\n                'last_degree',\n                'specialty'\n            ];\n\n            const completedFields = requiredFields.filter(field => {\n                const value = profile[field];\n                return value && value.toString().trim() !== '';\n            });\n\n            const percentage = Math.round((completedFields.length / requiredFields.length) * 100);\n\n            setCompletion({\n                percentage,\n                completedCount: completedFields.length,\n                totalCount: requiredFields.length,\n                missingFields: requiredFields.filter(f => !completedFields.includes(f))\n            });\n\n        } catch (err) {\n            console.error(\"Error checking profile:\", err);\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    // Don't show if loading or 100% complete\n    if (loading || !completion || completion.percentage === 100) return null;\n\n    const getColorClass = () => {\n        if (completion.percentage >= 75) return 'text-green-600 bg-green-50 border-green-200';\n        if (completion.percentage >= 50) return 'text-amber-600 bg-amber-50 border-amber-200';\n        return 'text-red-600 bg-red-50 border-red-200';\n    };\n\n    const getProgressColor = () => {\n        if (completion.percentage >= 75) return 'bg-green-500';\n        if (completion.percentage >= 50) return 'bg-amber-500';\n        return 'bg-red-500';\n    };\n\n    return (\n        <div\n            onClick={() => navigate(user?.app_metadata?.role === 'admin' ? '/admin/profile' : '/author/profile')}\n            className={`${getColorClass()} p-6 rounded-2xl border-2 shadow-sm cursor-pointer hover:shadow-lg transition-all duration-200 transform hover:scale-[1.02]`}\n        >\n            <div className=\"flex items-start gap-4\">\n                <div className=\"p-3 bg-white rounded-xl\">\n                    <AlertCircle className=\"w-6 h-6\" />\n                </div>\n                <div className=\"flex-1\">\n                    <div className=\"flex items-center justify-between mb-2\">\n                        <h3 className=\"font-bold text-lg\">Compl√©tez votre profil</h3>\n                        <span className=\"text-2xl font-bold\">{completion.percentage}%</span>\n                    </div>\n                    <p className=\"text-sm opacity-90 mb-4\">\n                        {completion.completedCount}/{completion.totalCount} informations remplies\n                    </p>\n\n                    {/* Progress Bar */}\n                    <div className=\"w-full bg-white/50 rounded-full h-3 overflow-hidden\">\n                        <div\n                            className={`${getProgressColor()} h-full transition-all duration-500 rounded-full`}\n                            style={{ width: `${completion.percentage}%` }}\n                        />\n                    </div>\n\n                    <p className=\"text-xs mt-3 opacity-75\">\n                        üëâ Cliquez pour compl√©ter vos informations\n                    </p>\n                </div>\n            </div>\n        </div>\n    );\n};\n\nexport default ProfileCompletionCard;\n","usedDeprecatedRules":[]},{"filePath":"/Users/mac/Desktop/akouass/note/site de publising/site 1 /src/components/auth/AdminRoute.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/mac/Desktop/akouass/note/site de publising/site 1 /src/components/auth/AuthorRoute.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/mac/Desktop/akouass/note/site de publising/site 1 /src/components/layouts/AdminLayout.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/mac/Desktop/akouass/note/site de publising/site 1 /src/components/layouts/AuthorLayout.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/mac/Desktop/akouass/note/site de publising/site 1 /src/contexts/AuthContext.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'loading' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":8,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":19,"suggestions":[{"messageId":"removeVar","data":{"varName":"loading"},"fix":{"range":[264,271],"text":""},"desc":"Remove unused variable 'loading'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'error' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":25,"column":31,"nodeType":"Identifier","messageId":"unusedVar","endLine":25,"endColumn":36,"suggestions":[{"messageId":"removeVar","data":{"varName":"error"},"fix":{"range":[993,1000],"text":""},"desc":"Remove unused variable 'error'."}]},{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":103,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":103,"endColumn":21}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { createContext, useContext, useState, useEffect } from 'react';\nimport { supabase } from '../supabaseClient';\n\nconst AuthContext = createContext(null);\n\nexport const AuthProvider = ({ children }) => {\n    const [user, setUser] = useState(null);\n    const [loading, setLoading] = useState(true);\n\n    const fetchProfile = async (authUser) => {\n        // 1. TRUST THE TOKEN FIRST (The \"Badge\") - OPTIMISTIC LOGIN\n        const jwtRole = authUser.app_metadata?.role;\n        console.log(\"AuthProvider: JWT Role is:\", jwtRole);\n\n        // CRITICAL FIX: Unlock the UI IMMEDIATELY. \n        const basicUser = { ...authUser, role: jwtRole || 'author' };\n        setUser(basicUser);\n        setLoading(false);\n\n        // 2. Background Sync: Fire and Forget\n        // We do NOT await this promise, so the login function returns instantly.\n        (async () => {\n            try {\n                console.log(\"AuthProvider: Starting background profile sync...\");\n                const { data, error } = await supabase\n                    .from('profiles')\n                    .select('*')\n                    .eq('id', authUser.id)\n                    .maybeSingle();\n\n                if (data) {\n                    console.log(\"AuthProvider: Profile sync complete.\");\n                    setUser(prev => ({ ...prev, ...data, role: jwtRole || data.role }));\n                }\n            } catch (error) {\n                console.warn('AuthProvider: Background profile fetch warning:', error);\n            }\n        })();\n    };\n\n    useEffect(() => {\n        let mounted = true;\n        console.log(\"AuthProvider: Initializing listener...\");\n\n        const { data: { subscription } } = supabase.auth.onAuthStateChange(async (event, session) => {\n            console.log(`AuthProvider: Event: ${event}`);\n\n            if (!mounted) return;\n\n            if (session?.user) {\n                // We have a session!\n                await fetchProfile(session.user);\n            } else {\n                // No session\n                setUser(null);\n                setLoading(false);\n            }\n        });\n\n        return () => {\n            mounted = false;\n            subscription.unsubscribe();\n        };\n    }, []);\n\n    const login = async (email, password) => {\n        const { data, error } = await supabase.auth.signInWithPassword({ email, password });\n        if (error) throw error;\n\n        // Critical: Manually update state immediately to prevent race conditions during navigation\n        // The listener will also fire, but we ensure 'user' is set here first.\n        if (data?.user) {\n            await fetchProfile(data.user);\n        }\n\n        return data;\n    };\n\n    const signup = async (email, password, fullName) => {\n        const { data, error } = await supabase.auth.signUp({\n            email,\n            password,\n            options: {\n                data: { full_name: fullName } // Passed to trigger\n            }\n        });\n        if (error) throw error;\n        return data;\n    };\n\n    const logout = async () => {\n        await supabase.auth.signOut();\n        setUser(null);\n    };\n\n    return (\n        <AuthContext.Provider value={{ user, login, signup, logout, fetchProfile }}>\n            {children}\n        </AuthContext.Provider>\n    );\n};\n\nexport const useAuth = () => useContext(AuthContext);\n","usedDeprecatedRules":[]},{"filePath":"/Users/mac/Desktop/akouass/note/site de publising/site 1 /src/i18n.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/mac/Desktop/akouass/note/site de publising/site 1 /src/main.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/mac/Desktop/akouass/note/site de publising/site 1 /src/pages/Landing.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/mac/Desktop/akouass/note/site de publising/site 1 /src/pages/admin/AIConfig.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/mac/Desktop/akouass/note/site de publising/site 1 /src/pages/admin/AIEvaluationManager.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'e' is defined but never used.","line":182,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":182,"endColumn":19}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\nimport { supabase } from '../../supabaseClient';\nimport { BrainCircuit, Star, FileText, User, Activity, AlertCircle, TrendingUp, BookOpen, Users, Flag, CheckCircle2, XCircle } from 'lucide-react';\n\nconst AIEvaluationManager = () => {\n    const [manuscripts, setManuscripts] = useState([]);\n    const [loading, setLoading] = useState(true);\n    const [error, setError] = useState(null);\n    const [analyzingId, setAnalyzingId] = useState(null);\n    const [customPrompt, setCustomPrompt] = useState(null);\n    const [expandedReview, setExpandedReview] = useState(null);\n\n    useEffect(() => {\n        fetchManuscripts();\n        fetchPrompts();\n    }, []);\n\n    const fetchPrompts = async () => {\n        const { data } = await supabase\n            .from('admin_settings')\n            .select('value')\n            .eq('key', 'ai_manuscript_prompt')\n            .single();\n        if (data) setCustomPrompt(data.value);\n    };\n\n    const fetchManuscripts = async () => {\n        setLoading(true);\n        setError(null);\n        try {\n            const { data: pubs, error: pubError } = await supabase\n                .from('publications')\n                .select('*')\n                .order('created_at', { ascending: false });\n\n            if (pubError) throw pubError;\n\n            if (pubs && pubs.length > 0) {\n                const userIds = [...new Set(pubs.map(p => p.user_id).filter(id => id))];\n                if (userIds.length > 0) {\n                    const { data: profs } = await supabase.from('profiles').select('*').in('id', userIds);\n                    if (profs) {\n                        const profMap = Object.fromEntries(profs.map(p => [p.id, p]));\n                        setManuscripts(pubs.map(p => ({ ...p, author_profile: profMap[p.user_id] || null })));\n                        return;\n                    }\n                }\n                setManuscripts(pubs);\n            } else {\n                setManuscripts([]);\n            }\n        } catch (err) {\n            console.error(err);\n            setError(err.message);\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const [provider, setProvider] = useState(() => localStorage.getItem('ai_provider') || 'gemini');\n    const [manualJson, setManualJson] = useState('');\n    const [showManualModal, setShowManualModal] = useState(null);\n    const [showSettings, setShowSettings] = useState(false);\n\n    // API Keys from LocalStorage\n    const [apiKeys, setApiKeys] = useState({\n        mistral: localStorage.getItem('key_mistral') || '',\n        openai: localStorage.getItem('key_openai') || '',\n        gemini: \"AIzaSyBpLSKJRT8AKsBDr3u0xNGtOspey_Iax9g\" // Default Gemini\n    });\n\n    const updateApiKey = (p, val) => {\n        setApiKeys(prev => ({ ...prev, [p]: val }));\n        localStorage.setItem(`key_${p}`, val);\n    };\n\n    const handleRunAI = async (m) => {\n        setAnalyzingId(m.id);\n        setError(null);\n        try {\n            console.log(`Expertise IA V2.0: Utilisation de ${provider} pour ${m.id}`);\n            localStorage.setItem('ai_provider', provider);\n\n            const prompt = (customPrompt || \"Analyze this manuscript and return JSON as requested:\")\n                .replace(\"{{title}}\", m.title_main || \"\")\n                .replace(\"{{summary}}\", m.summary || \"\")\n                .replace(\"{{keywords}}\", m.keywords || \"\")\n                .replace(\"{{author_profile}}\", JSON.stringify(m.author_profile || {}));\n\n            if (provider === 'manual') {\n                setShowManualModal({ manuscript: m, prompt: prompt });\n                setAnalyzingId(null);\n                return;\n            }\n\n            let aiResult = null;\n\n            if (provider === 'mistral') {\n                if (!apiKeys.mistral) throw new Error(\"Veuillez configurer votre cl√© Mistral dans les r√©glages (ic√¥ne ‚öôÔ∏è).\");\n                const response = await fetch(\"https://api.mistral.ai/v1/chat/completions\", {\n                    method: 'POST',\n                    headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${apiKeys.mistral}` },\n                    body: JSON.stringify({\n                        model: \"mistral-small-latest\",\n                        messages: [{ role: \"user\", content: prompt }],\n                        response_format: { type: \"json_object\" }\n                    })\n                });\n                if (!response.ok) {\n                    const err = await response.json().catch(() => ({}));\n                    throw new Error(err.error?.message || `Mistral Error ${response.status}`);\n                }\n                const data = await response.json();\n                aiResult = JSON.parse(data.choices[0].message.content);\n            } else if (provider === 'openai') {\n                if (!apiKeys.openai) throw new Error(\"Veuillez configurer votre cl√© OpenAI dans les r√©glages.\");\n                const response = await fetch(\"https://api.openai.com/v1/chat/completions\", {\n                    method: 'POST',\n                    headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${apiKeys.openai}` },\n                    body: JSON.stringify({\n                        model: \"gpt-4o-mini\",\n                        messages: [{ role: \"user\", content: prompt }],\n                        response_format: { type: \"json_object\" }\n                    })\n                });\n                if (!response.ok) {\n                    const err = await response.json().catch(() => ({}));\n                    throw new Error(err.error?.message || `OpenAI Error ${response.status}`);\n                }\n                const data = await response.json();\n                aiResult = JSON.parse(data.choices[0].message.content);\n            } else if (provider === 'gemini') {\n                const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${apiKeys.gemini}`;\n                const response = await fetch(url, {\n                    method: 'POST',\n                    headers: { 'Content-Type': 'application/json' },\n                    body: JSON.stringify({\n                        contents: [{ parts: [{ text: prompt }] }],\n                        generationConfig: { responseMimeType: \"application/json\" }\n                    })\n                });\n                if (!response.ok) throw new Error(`Gemini API Quota Error (429/400).`);\n                const data = await response.json();\n                let text = data.candidates?.[0]?.content?.parts?.[0]?.text;\n                text = text.replace(/```json\\n?/, '').replace(/\\n?```/, '').trim();\n                aiResult = JSON.parse(text);\n            }\n\n            if (aiResult) {\n                await updateManuscriptResult(m.id, aiResult);\n                fetchManuscripts();\n            }\n            setAnalyzingId(null);\n        } catch (err) {\n            console.error(\"Expertise IA Error:\", err);\n            setError(`L'IA (${provider}) a √©chou√© : ${err.message}`);\n            setAnalyzingId(null);\n        }\n    };\n\n    const updateManuscriptResult = async (id, result) => {\n        const { error: upErr } = await supabase\n            .from('publications')\n            .update({\n                ai_score: Math.round(result.final_evaluation?.overall_score || 0),\n                ai_detailed_review: result,\n                ai_status: 'completed'\n            })\n            .eq('id', id);\n        if (upErr) throw upErr;\n    };\n\n    const handleSaveManual = async () => {\n        try {\n            // Nettoyage Markdown au cas o√π l'utilisateur colle tout le bloc\n            let cleanJson = manualJson.replace(/```json\\n?/, '').replace(/\\n?```/, '').trim();\n            const result = JSON.parse(cleanJson);\n            await updateManuscriptResult(showManualModal.manuscript.id, result);\n            fetchManuscripts();\n            setShowManualModal(null);\n            setManualJson('');\n        } catch (e) {\n            alert(\"Erreur de format JSON. Assurez-vous de coller UNIQUEMENT le r√©sultat JSON (entre les accolades { }).\");\n        }\n    };\n\n    const getRecommendationStyle = (rec) => {\n        if (rec === 'publish') return 'bg-green-100 text-green-700 border-green-200';\n        if (rec === 'publish_with_revisions') return 'bg-amber-100 text-amber-700 border-amber-200';\n        return 'bg-red-100 text-red-700 border-red-200';\n    };\n\n    if (loading) return <div className=\"p-8 text-center text-gray-500 animate-pulse\">Initialisation du syst√®me d'√©valuation...</div>;\n\n    return (\n        <div className=\"space-y-8 pb-12\">\n            <div className=\"flex flex-col md:flex-row justify-between items-start gap-6\">\n                <div>\n                    <h1 className=\"text-3xl font-bold text-gray-900 flex items-center gap-3\">\n                        <BrainCircuit className=\"w-10 h-10 text-note-purple\" />\n                        Syst√®me d'Expertise IA 2.0\n                    </h1>\n                    <p className=\"text-gray-500 mt-2 max-w-2xl\">\n                        Choisissez votre moteur d'analyse. Mistral est conseill√© pour sa stabilit√© gratuite. Usez du mode manuel en cas de blocage.\n                    </p>\n                </div>\n\n                <div className=\"flex items-center gap-3\">\n                    <button\n                        onClick={() => setShowSettings(!showSettings)}\n                        className={`p-3 rounded-2xl border transition-all ${showSettings ? 'bg-note-purple text-white border-note-purple' : 'bg-white text-gray-400 border-gray-100 hover:border-note-purple hover:text-note-purple'}`}\n                        title=\"R√©glages des cl√©s API\"\n                    >\n                        <BrainCircuit className=\"w-5 h-5\" />\n                    </button>\n\n                    <div className=\"bg-white p-2 rounded-2xl border border-gray-100 shadow-sm flex items-center gap-2\">\n                        <span className=\"text-xs font-bold text-gray-400 px-3 uppercase\">Moteur :</span>\n                        <select\n                            value={provider}\n                            onChange={(e) => setProvider(e.target.value)}\n                            className=\"bg-gray-50 border-none text-sm font-bold text-note-purple rounded-xl px-4 py-2 focus:ring-2 focus:ring-note-purple outline-none\"\n                        >\n                            <option value=\"gemini\">Google Gemini (Free Tier)</option>\n                            <option value=\"mistral\">Mistral AI (Stable)</option>\n                            <option value=\"openai\">OpenAI GPT-4o Mini</option>\n                            <option value=\"manual\">Mode Manuel (Paste JSON)</option>\n                        </select>\n                    </div>\n                </div>\n            </div>\n\n            {/* Settings Panel */}\n            {showSettings && (\n                <div className=\"bg-violet-50 rounded-3xl p-8 border border-violet-100 animate-in slide-in-from-top-4 duration-300\">\n                    <div className=\"flex items-center gap-4 mb-6\">\n                        <div className=\"p-3 bg-white rounded-2xl shadow-sm text-note-purple\">\n                            <BrainCircuit className=\"w-6 h-6\" />\n                        </div>\n                        <div>\n                            <h3 className=\"text-lg font-black text-gray-900\">Configuration des IA</h3>\n                            <p className=\"text-sm text-gray-500 font-medium\">Configurez vos cl√©s API pour une autonomie totale.</p>\n                        </div>\n                    </div>\n\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                        <div className=\"space-y-2\">\n                            <label className=\"text-[10px] font-black text-gray-400 uppercase tracking-widest px-1\">Cl√© Mistral AI</label>\n                            <input\n                                type=\"password\"\n                                value={apiKeys.mistral}\n                                onChange={(e) => updateApiKey('mistral', e.target.value)}\n                                placeholder=\"Collez votre cl√© mistral.ai\"\n                                className=\"w-full bg-white border border-violet-100 rounded-xl px-4 py-3 text-sm focus:ring-2 focus:ring-note-purple outline-none transition-all\"\n                            />\n                        </div>\n                        <div className=\"space-y-2\">\n                            <label className=\"text-[10px] font-black text-gray-400 uppercase tracking-widest px-1\">Cl√© OpenAI</label>\n                            <input\n                                type=\"password\"\n                                value={apiKeys.openai}\n                                onChange={(e) => updateApiKey('openai', e.target.value)}\n                                placeholder=\"sk-...\"\n                                className=\"w-full bg-white border border-violet-100 rounded-xl px-4 py-3 text-sm focus:ring-2 focus:ring-note-purple outline-none transition-all\"\n                            />\n                        </div>\n                    </div>\n                    <div className=\"mt-6 pt-6 border-t border-violet-100 text-[10px] text-violet-400 font-bold uppercase tracking-widest\">\n                        Les cl√©s sont sauvegard√©es localement dans votre navigateur uniquement.\n                    </div>\n                </div>\n            )}\n\n            {error && (\n                <div className=\"bg-red-50 text-red-800 p-4 rounded-2xl border border-red-200 flex items-start gap-3\">\n                    <AlertCircle className=\"w-5 h-5 mt-0.5\" />\n                    <div><h4 className=\"font-bold\">Erreur Technique</h4><p className=\"text-sm\">{error}</p></div>\n                </div>\n            )}\n\n            {/* Manual Entry Modal - ENHANCED */}\n            {showManualModal && (\n                <div className=\"fixed inset-0 bg-black/70 backdrop-blur-md z-50 flex items-center justify-center p-6\">\n                    <div className=\"bg-white rounded-[40px] w-full max-w-4xl max-h-[90vh] overflow-hidden shadow-2xl flex flex-col animate-in zoom-in-95 duration-200\">\n                        <div className=\"p-8 border-b border-gray-50 flex justify-between items-center bg-gray-50/50\">\n                            <div>\n                                <h3 className=\"text-2xl font-black text-gray-900 leading-tight\">Expertise Manuelle : {showManualModal.manuscript.title_main}</h3>\n                                <p className=\"text-gray-500 text-sm font-medium\">Bypassez les limites d'API en utilisant l'IA de votre choix (ChatGPT, Claude, etc.)</p>\n                            </div>\n                            <button onClick={() => setShowManualModal(null)} className=\"p-2 hover:bg-gray-200 rounded-full transition-colors text-gray-400\">\n                                <XCircle className=\"w-6 h-6\" />\n                            </button>\n                        </div>\n\n                        <div className=\"flex-1 overflow-y-auto p-8 grid grid-cols-1 lg:grid-cols-2 gap-8\">\n                            {/* Step 1: Prompt Generation */}\n                            <div className=\"space-y-4\">\n                                <div className=\"flex items-center gap-2 mb-2\">\n                                    <div className=\"w-8 h-8 rounded-full bg-note-purple text-white flex items-center justify-center text-xs font-black\">1</div>\n                                    <h4 className=\"font-bold text-gray-900 uppercase text-xs tracking-widest\">G√©n√©rer le Prompt</h4>\n                                </div>\n                                <div className=\"relative group\">\n                                    <textarea\n                                        readOnly\n                                        value={showManualModal.prompt}\n                                        className=\"w-full h-[400px] bg-gray-50 rounded-2xl p-6 font-mono text-[10px] text-gray-600 border border-gray-100 outline-none resize-none\"\n                                    />\n                                    <button\n                                        onClick={() => {\n                                            navigator.clipboard.writeText(showManualModal.prompt);\n                                            alert(\"Prompt copi√© ! Collez-le maintenant dans ChatGPT ou Gemini.\");\n                                        }}\n                                        className=\"absolute bottom-4 right-4 bg-white border border-gray-200 px-4 py-2 rounded-xl text-xs font-bold text-note-purple shadow-sm hover:bg-note-purple hover:text-white transition-all flex items-center gap-2\"\n                                    >\n                                        <TrendingUp className=\"w-3 h-3\" /> COPIER LE CODE AI\n                                    </button>\n                                </div>\n                                <p className=\"text-[10px] text-gray-400 italic\">Ce code contient toutes les m√©tadonn√©es du manuscrit et les instructions de formatage.</p>\n                            </div>\n\n                            {/* Step 2: Result Pasting */}\n                            <div className=\"space-y-4\">\n                                <div className=\"flex items-center gap-2 mb-2\">\n                                    <div className=\"w-8 h-8 rounded-full bg-emerald-500 text-white flex items-center justify-center text-xs font-black\">2</div>\n                                    <h4 className=\"font-bold text-gray-900 uppercase text-xs tracking-widest\">Coller le R√©sultat (JSON)</h4>\n                                </div>\n                                <textarea\n                                    value={manualJson}\n                                    onChange={(e) => setManualJson(e.target.value)}\n                                    placeholder='Collez ici la r√©ponse de l‚ÄôIA (le bloc de code JSON)...'\n                                    className=\"w-full h-[400px] bg-emerald-50/30 rounded-2xl p-6 font-mono text-[10px] text-emerald-900 border border-emerald-100 focus:border-emerald-500 focus:bg-white transition-all outline-none resize-none\"\n                                />\n                                <button\n                                    onClick={handleSaveManual}\n                                    disabled={!manualJson.trim()}\n                                    className=\"w-full bg-note-purple text-white py-4 rounded-2xl font-black shadow-lg shadow-purple-200 hover:scale-[1.01] active:scale-[0.99] transition-all disabled:opacity-50 disabled:scale-100\"\n                                >\n                                    ENREGISTRER LE RAPPORT INSTITUTIONNEL\n                                </button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            )}\n\n            <div className=\"grid grid-cols-1 gap-8\">\n                {manuscripts.map((m) => {\n                    const review = m.ai_detailed_review;\n                    const isExpanded = expandedReview === m.id;\n\n                    return (\n                        <div key={m.id} className={`bg-white rounded-3xl border ${isExpanded ? 'border-note-purple shadow-xl' : 'border-gray-100 shadow-sm'} overflow-hidden transition-all duration-300`}>\n                            {/* Header Panel */}\n                            <div className=\"p-8 flex flex-col md:flex-row gap-8 items-center bg-white\">\n                                <div className=\"flex-1 space-y-2\">\n                                    <div className=\"flex items-center gap-3 mb-1\">\n                                        <span className=\"px-3 py-1 bg-violet-50 text-note-purple text-[10px] font-bold uppercase tracking-wider rounded-full border border-violet-100\">\n                                            {review?.language_detected === 'ar' ? 'Mati√®re Arabophone' : 'Mati√®re Francophone'}\n                                        </span>\n                                        <span className=\"text-xs text-gray-400 font-medium tracking-tight\">ID: {m.id.split('-')[0]}</span>\n                                    </div>\n                                    <h2 className=\"text-2xl font-black text-gray-900 tracking-tight leading-tight\">{m.title_main}</h2>\n                                    <div className=\"flex items-center gap-4 pt-2\">\n                                        <div className=\"flex items-center gap-2\">\n                                            <div className=\"w-8 h-8 rounded-lg bg-gray-50 flex items-center justify-center text-gray-400 border border-gray-100\">\n                                                <User className=\"w-4 h-4\" />\n                                            </div>\n                                            <span className=\"text-sm font-bold text-gray-700\">{m.main_author_name} {m.main_author_firstname}</span>\n                                        </div>\n                                    </div>\n                                </div>\n\n                                <div className=\"flex flex-col items-center md:items-end gap-3 min-w-[200px]\">\n                                    {m.ai_status === 'completed' ? (\n                                        <div className=\"text-right\">\n                                            <div className=\"flex items-center gap-2 mb-1 justify-end\">\n                                                <span className=\"text-4xl font-black text-note-purple\">{review?.final_evaluation?.overall_score}</span>\n                                                <span className=\"text-gray-300 text-lg\">/10</span>\n                                            </div>\n                                            <span className={`px-4 py-1.5 rounded-xl text-xs font-black uppercase border shadow-sm ${getRecommendationStyle(review?.final_evaluation?.final_recommendation)}`}>\n                                                {review?.final_evaluation?.final_recommendation?.replace(/_/g, ' ')}\n                                            </span>\n                                        </div>\n                                    ) : (\n                                        <button\n                                            onClick={() => handleRunAI(m)}\n                                            disabled={analyzingId !== null}\n                                            className=\"bg-note-purple text-white px-8 py-3 rounded-2xl font-black text-sm hover:bg-violet-700 transition-all hover:scale-105 active:scale-95 disabled:bg-gray-100 disabled:text-gray-400\"\n                                        >\n                                            {analyzingId === m.id ? 'ANALYSES EN COURS...' : 'LANCER L\\'EXPERTISE'}\n                                        </button>\n                                    )}\n                                    <button\n                                        onClick={() => setExpandedReview(isExpanded ? null : m.id)}\n                                        className=\"text-xs font-bold text-gray-400 hover:text-note-purple flex items-center gap-1\"\n                                    >\n                                        {isExpanded ? 'R√©duire les d√©tails' : 'D√©tails de l\\'analyse ‚Üí'}\n                                    </button>\n                                </div>\n                            </div>\n\n                            {/* Detailed Review Section */}\n                            {isExpanded && review && (\n                                <div className=\"border-t border-gray-50 bg-gray-50/30 p-8 space-y-8 animate-in slide-in-from-top duration-500\">\n                                    <div className=\"grid grid-cols-1 md:grid-cols-4 gap-6\">\n                                        <div className=\"bg-white p-5 rounded-2xl border border-gray-100 shadow-sm\">\n                                            <TrendingUp className=\"w-5 h-5 text-blue-500 mb-3\" />\n                                            <h4 className=\"text-xs font-bold text-gray-400 uppercase mb-1\">March√© (30%)</h4>\n                                            <p className=\"text-xl font-black text-gray-900\">{review.market_analysis?.weighted_score}/10</p>\n                                            <p className=\"text-[10px] text-gray-500 mt-1 uppercase\">Saturation: {review.market_analysis?.market_saturation_level}</p>\n                                        </div>\n                                        <div className=\"bg-white p-5 rounded-2xl border border-gray-100 shadow-sm\">\n                                            <BookOpen className=\"w-5 h-5 text-violet-500 mb-3\" />\n                                            <h4 className=\"text-xs font-bold text-gray-400 uppercase mb-1\">Contenu (40%)</h4>\n                                            <p className=\"text-xl font-black text-gray-900\">{review.content_evaluation?.weighted_score}/10</p>\n                                            <p className=\"text-[10px] text-gray-500 mt-1 uppercase\">Plagiat: {review.content_evaluation?.plagiarism_risk_percent}%</p>\n                                        </div>\n                                        <div className=\"bg-white p-5 rounded-2xl border border-gray-100 shadow-sm\">\n                                            <Users className=\"w-5 h-5 text-orange-500 mb-3\" />\n                                            <h4 className=\"text-xs font-bold text-gray-400 uppercase mb-1\">Auteur (15%)</h4>\n                                            <p className=\"text-xl font-black text-gray-900\">{review.author_evaluation?.weighted_score}/10</p>\n                                            <p className=\"text-[10px] text-gray-500 mt-1 uppercase\">Marketing: {review.author_evaluation?.marketing_potential_score}/10</p>\n                                        </div>\n                                        <div className=\"bg-white p-5 rounded-2xl border border-gray-100 shadow-sm\">\n                                            <Flag className=\"w-5 h-5 text-emerald-500 mb-3\" />\n                                            <h4 className=\"text-xs font-bold text-gray-400 uppercase mb-1\">Impact (15%)</h4>\n                                            <p className=\"text-xl font-black text-gray-900\">8.0/10</p>\n                                            <p className=\"text-[10px] text-gray-500 mt-1 uppercase\">Concurrentiel</p>\n                                        </div>\n                                    </div>\n\n                                    <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-8\">\n                                        <div className=\"space-y-4\">\n                                            <h4 className=\"font-bold text-gray-800 flex items-center gap-2\">\n                                                <CheckCircle2 className=\"w-5 h-5 text-green-500\" /> Forces Strat√©giques\n                                            </h4>\n                                            <div className=\"flex flex-wrap gap-2\">\n                                                {review.final_evaluation?.strengths?.map((s, i) => (\n                                                    <span key={i} className=\"bg-white px-4 py-2 rounded-xl border border-green-100 text-sm text-green-700 font-medium\">{s}</span>\n                                                ))}\n                                            </div>\n                                        </div>\n                                        <div className=\"space-y-4\">\n                                            <h4 className=\"font-bold text-gray-800 flex items-center gap-2\">\n                                                <XCircle className=\"w-5 h-5 text-red-500\" /> Points de Vigilance\n                                            </h4>\n                                            <div className=\"flex flex-wrap gap-2\">\n                                                {review.final_evaluation?.weaknesses?.map((w, i) => (\n                                                    <span key={i} className=\"bg-white px-4 py-2 rounded-xl border border-red-100 text-sm text-red-700 font-medium\">{w}</span>\n                                                ))}\n                                            </div>\n                                        </div>\n                                    </div>\n\n                                    <div className=\"bg-white p-6 rounded-3xl border border-gray-100 shadow-sm\">\n                                        <h4 className=\"text-xs font-bold text-gray-400 uppercase mb-4\">Justification Institutionnelle</h4>\n                                        <p className=\"text-gray-700 leading-relaxed italic\">\"{review.final_evaluation?.decision_justification}\"</p>\n                                    </div>\n                                </div>\n                            )}\n                        </div>\n                    );\n                })}\n\n                {manuscripts.length === 0 && (\n                    <div className=\"text-center py-20 bg-white rounded-[40px] border-4 border-dashed border-gray-50\">\n                        <Activity className=\"w-16 h-16 text-gray-100 mx-auto mb-4\" />\n                        <h3 className=\"font-black text-gray-300 text-2xl\">VOTRE PIPELINE EST VIDE</h3>\n                        <p className=\"text-gray-400\">Aucun manuscrit n'est actuellement en attente d'expertise.</p>\n                    </div>\n                )}\n            </div>\n        </div>\n    );\n};\n\nexport default AIEvaluationManager;\n","usedDeprecatedRules":[]},{"filePath":"/Users/mac/Desktop/akouass/note/site de publising/site 1 /src/pages/admin/ContentManager.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/mac/Desktop/akouass/note/site de publising/site 1 /src/pages/admin/CreateUser.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'supabase' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":18,"suggestions":[{"messageId":"removeVar","data":{"varName":"supabase"},"fix":{"range":[136,184],"text":""},"desc":"Remove unused variable 'supabase'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'authData' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":44,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":44,"endColumn":35,"suggestions":[{"messageId":"removeVar","data":{"varName":"authData"},"fix":{"range":[1590,1605],"text":""},"desc":"Remove unused variable 'authData'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { createClient } from '@supabase/supabase-js';\nimport { supabase } from '../../supabaseClient'; // Default client for profiles\nimport { ArrowLeft, Save, User, Mail, Lock } from 'lucide-react';\n\n// Create a separate client for creation to avoid replacing the current session\n// This is a \"hack\" for client-side admin creation without Edge Functions\nconst supabaseUrl = import.meta.env.VITE_SUPABASE_URL || \"https://ueeensmyaqsbruezyjwe.supabase.co\";\nconst supabaseKey = import.meta.env.VITE_SUPABASE_ANON_KEY || \"sb_publishable_Pwkeq6QyrIgUvLSbo8prGQ_9LF83oBu\";\n\nconst tempClient = createClient(supabaseUrl, supabaseKey, {\n    auth: {\n        persistSession: false, // CRITICAL: Don't store this session (prevents logout)\n        autoRefreshToken: false,\n        detectSessionInUrl: false,\n        storageKey: 'temp-admin-creation' // Unique key to avoid conflict warning\n    }\n});\n\nconst CreateUser = () => {\n    const navigate = useNavigate();\n    const [loading, setLoading] = useState(false);\n    const [error, setError] = useState(null);\n\n    const [formData, setFormData] = useState({\n        email: '',\n        password: '',\n        fullName: '',\n        role: 'author'\n    });\n\n    const handleChange = (e) => {\n        setFormData({ ...formData, [e.target.name]: e.target.value });\n    };\n\n    const handleSubmit = async (e) => {\n        e.preventDefault();\n        setLoading(true);\n        setError(null);\n\n        try {\n            // 1. Create User (using temp client)\n            const { data: authData, error: authError } = await tempClient.auth.signUp({\n                email: formData.email,\n                password: formData.password,\n                options: {\n                    data: {\n                        full_name: formData.fullName,\n                        // Note: We can try to set role here, but our Trigger might overwrite it \n                        // or we might need to rely on default.\n                        // Since we switched to Custom Claims, we might want to set app_metadata here?\n                        // But users can't set their own app_metadata. \n                        // So relying on Trigger + manually updating role later is safer.\n                    }\n                }\n            });\n\n            if (authError) throw authError;\n\n            // 2. Profile Creation handled by Trigger automatically\n            // We do NOT manual upsert anymore to avoid RLS strict policy blocks.\n\n            if (formData.role === 'admin') {\n                alert(\"L'utilisateur a √©t√© cr√©√© avec le r√¥le 'Auteur' par d√©faut. Veuillez modifier son r√¥le en 'Admin' depuis la liste.\");\n            } else {\n                alert(\"Utilisateur cr√©√© avec succ√®s !\");\n            }\n\n            navigate('/admin/users');\n\n        } catch (err) {\n            console.error(\"Creation error:\", err);\n            setError(err.message);\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    return (\n        <div className=\"max-w-2xl mx-auto\">\n            <div className=\"mb-8 flex items-center gap-4\">\n                <button\n                    onClick={() => navigate('/admin/users')}\n                    className=\"p-2 rounded-full hover:bg-gray-100 text-gray-500 transition-colors\"\n                >\n                    <ArrowLeft className=\"w-5 h-5\" />\n                </button>\n                <div>\n                    <h1 className=\"text-2xl font-bold text-gray-800\">Ajouter un utilisateur</h1>\n                    <p className=\"text-gray-500 text-sm\">Cr√©er un nouveau compte manuellement</p>\n                </div>\n            </div>\n\n            <form onSubmit={handleSubmit} className=\"bg-white rounded-2xl border border-gray-200 shadow-sm p-8 space-y-6\">\n                {error && (\n                    <div className=\"bg-red-50 text-red-600 p-4 rounded-lg border border-red-100 text-sm\">\n                        {error}\n                    </div>\n                )}\n\n                <div>\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">Nom Complet</label>\n                    <div className=\"relative group\">\n                        <User className=\"absolute left-3 top-2.5 h-5 w-5 text-gray-400\" />\n                        <input\n                            name=\"fullName\"\n                            type=\"text\"\n                            required\n                            value={formData.fullName}\n                            onChange={handleChange}\n                            className=\"w-full bg-gray-50 border border-gray-200 rounded-lg py-2 pl-10 pr-4 focus:ring-2 focus:ring-note-purple/20 focus:border-note-purple outline-none\"\n                            placeholder=\"John Doe\"\n                        />\n                    </div>\n                </div>\n\n                <div>\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">Email</label>\n                    <div className=\"relative group\">\n                        <Mail className=\"absolute left-3 top-2.5 h-5 w-5 text-gray-400\" />\n                        <input\n                            name=\"email\"\n                            type=\"email\"\n                            required\n                            value={formData.email}\n                            onChange={handleChange}\n                            className=\"w-full bg-gray-50 border border-gray-200 rounded-lg py-2 pl-10 pr-4 focus:ring-2 focus:ring-note-purple/20 focus:border-note-purple outline-none\"\n                            placeholder=\"john@example.com\"\n                        />\n                    </div>\n                </div>\n\n                <div>\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">Mot de passe provisoire</label>\n                    <div className=\"relative group\">\n                        <Lock className=\"absolute left-3 top-2.5 h-5 w-5 text-gray-400\" />\n                        <input\n                            name=\"password\"\n                            type=\"password\"\n                            required\n                            minLength={6}\n                            value={formData.password}\n                            onChange={handleChange}\n                            className=\"w-full bg-gray-50 border border-gray-200 rounded-lg py-2 pl-10 pr-4 focus:ring-2 focus:ring-note-purple/20 focus:border-note-purple outline-none\"\n                            placeholder=\"‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢\"\n                        />\n                    </div>\n                </div>\n\n                <div>\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">R√¥le</label>\n                    <select\n                        name=\"role\"\n                        value={formData.role}\n                        onChange={handleChange}\n                        className=\"w-full bg-gray-50 border border-gray-200 rounded-lg px-4 py-2 text-gray-900 focus:ring-2 focus:ring-note-purple/20 focus:border-note-purple outline-none\"\n                    >\n                        <option value=\"author\">Auteur</option>\n                        <option value=\"admin\">Administrateur</option>\n                    </select>\n                </div>\n\n                <div className=\"pt-4 flex justify-end gap-3\">\n                    <button\n                        type=\"button\"\n                        onClick={() => navigate('/admin/users')}\n                        className=\"px-6 py-2 border border-gray-200 text-gray-600 rounded-lg font-bold hover:bg-white transition-colors\"\n                    >\n                        Annuler\n                    </button>\n                    <button\n                        type=\"submit\"\n                        disabled={loading}\n                        className=\"px-6 py-2 bg-note-purple text-white rounded-lg font-bold hover:bg-violet-700 shadow-md flex items-center gap-2 disabled:opacity-70 disabled:cursor-not-allowed\"\n                    >\n                        {loading ? 'Cr√©ation...' : 'Cr√©er le compte'}\n                    </button>\n                </div>\n            </form>\n        </div>\n    );\n};\n\nexport default CreateUser;\n","usedDeprecatedRules":[]},{"filePath":"/Users/mac/Desktop/akouass/note/site de publising/site 1 /src/pages/admin/DashboardHome.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'Icon' is defined but never used.","line":7,"column":41,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":45,"suggestions":[{"messageId":"removeVar","data":{"varName":"Icon"},"fix":{"range":[319,331],"text":""},"desc":"Remove unused variable 'Icon'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Users, BookOpen, Clock, CheckCircle } from 'lucide-react';\nimport { supabase } from '../../supabaseClient';\nimport ProfileCompletionCard from '../../components/ProfileCompletionCard';\n\nconst StatCard = ({ title, value, icon: Icon, color, trend }) => (\n    <div className=\"bg-white p-6 rounded-2xl border border-gray-100 shadow-sm hover:shadow-md transition-shadow\">\n        <div className=\"flex justify-between items-start\">\n            <div>\n                <p className=\"text-gray-500 text-sm font-medium mb-1\">{title}</p>\n                <h3 className=\"text-2xl font-bold text-gray-800\">{value}</h3>\n            </div>\n            <div className={`p-3 rounded-xl bg-${color}-50 text-${color}-600`}>\n                <Icon className=\"w-6 h-6\" />\n            </div>\n        </div>\n        {trend && (\n            <div className=\"mt-4 flex items-center text-xs\">\n                <span className={`font-medium ${trend >= 0 ? 'text-green-500' : 'text-red-500'}`}>\n                    {trend > 0 ? '+' : ''}{trend}%\n                </span>\n                <span className=\"text-gray-400 ml-2\">vs last month</span>\n            </div>\n        )}\n    </div>\n);\n\nconst DashboardHome = () => {\n    const { t } = useTranslation();\n    const [counts, setCounts] = useState({ users: 0, publications: 0, pending: 0, validated: 0 });\n    const [recentUsers, setRecentUsers] = useState([]);\n    const [recentPubs, setRecentPubs] = useState([]);\n    const [loading, setLoading] = useState(true);\n\n    useEffect(() => {\n        const fetchDashboardData = async () => {\n            try {\n                // 1. Counts\n                const { count: usersCount } = await supabase.from('profiles').select('*', { count: 'exact', head: true });\n                const { count: pubCount } = await supabase.from('publications').select('*', { count: 'exact', head: true });\n                const { count: pendingCount } = await supabase.from('publications').select('*', { count: 'exact', head: true }).eq('position', 'en attente');\n                const { count: validCount } = await supabase.from('publications').select('*', { count: 'exact', head: true }).eq('position', 'valid√©');\n\n                setCounts({\n                    users: usersCount || 0,\n                    publications: pubCount || 0,\n                    pending: pendingCount || 0,\n                    validated: validCount || 0\n                });\n\n                // 2. Recent Users\n                const { data: rUsers } = await supabase\n                    .from('profiles')\n                    .select('*')\n                    .order('created_at', { ascending: false })\n                    .limit(5);\n                setRecentUsers(rUsers || []);\n\n                // 3. Recent Publications\n                const { data: rPubs } = await supabase\n                    .from('publications')\n                    .select('*')\n                    .order('created_at', { ascending: false })\n                    .limit(5);\n                setRecentPubs(rPubs || []);\n\n            } catch (error) {\n                console.error(\"Error loading dashboard:\", error);\n            } finally {\n                setLoading(false);\n            }\n        };\n\n        fetchDashboardData();\n    }, []);\n\n    const stats = [\n        { title: \"Total Utilisateurs\", value: counts.users, icon: Users, color: \"violet\" },\n        { title: \"Total Manuscrits\", value: counts.publications, icon: BookOpen, color: \"blue\" },\n        { title: \"En attente\", value: counts.pending, icon: Clock, color: \"amber\" },\n        { title: \"Valid√©s\", value: counts.validated, icon: CheckCircle, color: \"green\" },\n    ];\n\n    if (loading) return <div className=\"p-8 text-center text-gray-500\">Chargement du tableau de bord...</div>;\n\n    return (\n        <div className=\"space-y-8\">\n            {/* Page Header */}\n            <div>\n                <h1 className=\"text-2xl font-bold text-gray-800\">\n                    {t('admin_dashboard_title', 'Tableau de bord')}\n                </h1>\n                <p className=\"text-gray-500 mt-1\">\n                    {t('admin_dashboard_subtitle', 'Bienvenue dans votre espace de gestion.')}\n                </p>\n            </div>\n\n            {/* Profile Completion Card */}\n            <ProfileCompletionCard />\n\n            {/* Stats Grid */}\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\n                {stats.map((stat, index) => (\n                    <StatCard key={index} {...stat} />\n                ))}\n            </div>\n\n            {/* Recent Activity Section */}\n            <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-8\">\n                {/* Recent Users */}\n                <div className=\"bg-white p-6 rounded-2xl border border-gray-100 shadow-sm\">\n                    <h3 className=\"font-bold text-gray-800 mb-4\">Inscriptions R√©centes</h3>\n                    <div className=\"space-y-4\">\n                        {recentUsers.length === 0 ? (\n                            <p className=\"text-gray-400 text-sm\">Aucun utilisateur r√©cent.</p>\n                        ) : (\n                            recentUsers.map((u) => (\n                                <div key={u.id} className=\"flex items-center justify-between py-2 border-b border-gray-50 last:border-0\">\n                                    <div className=\"flex items-center gap-3\">\n                                        <div className=\"w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center text-gray-500 font-bold\">\n                                            {u.full_name?.charAt(0) || 'U'}\n                                        </div>\n                                        <div>\n                                            <p className=\"font-medium text-gray-800\">{u.full_name || 'Utilisateur'}</p>\n                                            <p className=\"text-xs text-gray-400\">{u.email}</p>\n                                        </div>\n                                    </div>\n                                    <span className=\"text-xs text-gray-400\">\n                                        {u.created_at ? new Date(u.created_at).toLocaleDateString() : ''}\n                                    </span>\n                                </div>\n                            ))\n                        )}\n                    </div>\n                </div>\n\n                {/* Recent Submissions */}\n                <div className=\"bg-white p-6 rounded-2xl border border-gray-100 shadow-sm\">\n                    <h3 className=\"font-bold text-gray-800 mb-4\">Derniers Manuscrits</h3>\n                    <div className=\"space-y-4\">\n                        {recentPubs.length === 0 ? (\n                            <p className=\"text-gray-400 text-sm\">Aucun manuscrit r√©cent.</p>\n                        ) : (\n                            recentPubs.map((p) => (\n                                <div key={p.id} className=\"flex items-center justify-between py-2 border-b border-gray-50 last:border-0\">\n                                    <div className=\"flex items-center gap-3\">\n                                        <div className=\"w-10 h-10 rounded-lg bg-blue-50 flex items-center justify-center text-blue-600\">\n                                            <BookOpen className=\"w-5 h-5\" />\n                                        </div>\n                                        <div>\n                                            <p className=\"font-medium text-gray-800 truncate max-w-[150px]\">{p.title_main}</p>\n                                            <p className=\"text-xs text-gray-400\">{new Date(p.created_at).toLocaleDateString()}</p>\n                                        </div>\n                                    </div>\n                                    <span className={`px-2 py-1 rounded-full text-xs font-medium ${p.position === 'valid√©' ? 'bg-green-50 text-green-600' :\n                                        p.position === 'en attente' ? 'bg-amber-50 text-amber-600' :\n                                            'bg-gray-100 text-gray-600'\n                                        }`}>\n                                        {p.position}\n                                    </span>\n                                </div>\n                            ))\n                        )}\n                    </div>\n                </div>\n            </div>\n        </div>\n    );\n};\n\nexport default DashboardHome;\n","usedDeprecatedRules":[]},{"filePath":"/Users/mac/Desktop/akouass/note/site de publising/site 1 /src/pages/admin/PublicationForm.jsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchPublication'. Either include it or remove the dependency array.","line":53,"column":8,"nodeType":"ArrayExpression","endLine":53,"endColumn":12,"suggestions":[{"desc":"Update the dependencies array to be: [fetchPublication, id]","fix":{"range":[1664,1668],"text":"[fetchPublication, id]"}}]},{"ruleId":"no-unused-vars","severity":2,"message":"'type' is defined but never used.","line":102,"column":39,"nodeType":"Identifier","messageId":"unusedVar","endLine":102,"endColumn":43,"suggestions":[{"messageId":"removeVar","data":{"varName":"type"},"fix":{"range":[3319,3325],"text":""},"desc":"Remove unused variable 'type'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'_' is defined but never used.","line":199,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":199,"endColumn":28,"suggestions":[{"messageId":"removeVar","data":{"varName":"_"},"fix":{"range":[6610,6611],"text":""},"desc":"Remove unused variable '_'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'_' is defined but never used.","line":200,"column":31,"nodeType":"Identifier","messageId":"unusedVar","endLine":200,"endColumn":32,"suggestions":[{"messageId":"removeVar","data":{"varName":"_"},"fix":{"range":[6683,6686],"text":""},"desc":"Remove unused variable '_'."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\nimport { useNavigate, useParams } from 'react-router-dom';\nimport { supabase } from '../../supabaseClient';\nimport { useAuth } from '../../contexts/AuthContext';\nimport { Save, ArrowLeft, X, Printer, CheckCircle, Upload } from 'lucide-react';\n\nconst PublicationForm = () => {\n    const navigate = useNavigate();\n    const { id } = useParams();\n    const { user } = useAuth(); // Need user to set user_id\n    const [loading, setLoading] = useState(false);\n\n    const [formData, setFormData] = useState({\n        editor_name: 'Dar note',\n        title_main: '',\n        title_secondary: '',\n        title_parallel: '',\n        language: 'Arabe',\n        publisher_1: '', place_1: '',\n        publisher_2: '', place_2: '', publication_year: '',\n        summary: '',\n        abstract: '',\n        keywords: '',\n        isbn: '',\n        position: 'en saisie',\n        collection_title: '',\n        collection_number: '',\n        main_author_name: '',\n        main_author_firstname: '',\n        author_2_name: '',\n        author_2_firstname: '',\n        author_2_role: 'Pr√©paration',\n        page_count: '',\n        illustrations: '',\n        volume_count: '',\n        format: '',\n        // Dates\n        date_validation_request: null,\n        date_validation: null,\n        date_isbn: null,\n        date_depot: null\n    });\n\n    // Check permissions\n    const isAuthor = user?.app_metadata?.role === 'author';\n    // Locked if author AND status is NOT 'en saisie'\n    const isLocked = isAuthor && formData.position !== 'en saisie';\n\n    useEffect(() => {\n        if (id) {\n            fetchPublication();\n        }\n    }, [id]);\n\n    const fetchPublication = async () => {\n        setLoading(true);\n        try {\n            const { data, error } = await supabase\n                .from('publications')\n                .select('*')\n                .eq('id', id)\n                .single();\n\n            if (error) throw error;\n            if (data) setFormData(data);\n        } catch (err) {\n            console.error(\"Error fetching publication:\", err);\n            alert(\"Erreur chargement: \" + err.message);\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const [files, setFiles] = useState({ doc: null, pdf: null });\n\n    const handleFileChange = (e, type) => {\n        if (e.target.files && e.target.files[0]) {\n            setFiles(prev => ({ ...prev, [type]: e.target.files[0] }));\n        }\n    };\n\n    const uploadFileToStorage = async (file, type) => {\n        // Sanitize names for folder paths (remove special chars)\n        const sanitize = (str) => str?.replace(/[^a-z0-9]/gi, '_').toLowerCase() || 'unknown';\n\n        const authorName = sanitize(user.user_metadata?.full_name || 'author');\n        const bookTitle = sanitize(formData.title_main || 'untitled');\n        const fileExt = file.name.split('.').pop();\n\n        // Structure: author_name/book_title/type.ext\n        const filePath = `${authorName}/${bookTitle}/${type}.${fileExt}`;\n\n        // Upsert (overwrite) if exists to keep it clean\n        const { error } = await supabase.storage\n            .from('manuscripts')\n            .upload(filePath, file, { upsert: true });\n\n        if (error) throw error;\n        return filePath;\n    };\n\n    const downloadFile = async (path, type) => {\n        try {\n            const { data, error } = await supabase.storage\n                .from('manuscripts')\n                .createSignedUrl(path, 60); // Valid for 60 seconds\n\n            if (error) throw error;\n            window.open(data.signedUrl, '_blank');\n        } catch (err) {\n            alert(\"Erreur lors du t√©l√©chargement: \" + err.message);\n        }\n    };\n\n    const handleChange = (e) => {\n        const { name, value } = e.target;\n        setFormData(prev => ({ ...prev, [name]: value }));\n    };\n\n    const handleSubmit = async (e) => {\n        e.preventDefault();\n        setLoading(true);\n\n        try {\n            // 1. Upload Files if present\n            let docPath = formData.file_doc_url;\n            let pdfPath = formData.file_pdf_url;\n\n            if (files.doc) {\n                docPath = await uploadFileToStorage(files.doc, 'doc');\n            }\n            if (files.pdf) {\n                pdfPath = await uploadFileToStorage(files.pdf, 'pdf');\n            }\n\n            const dataToSave = {\n                ...formData,\n                file_doc_url: docPath,\n                file_pdf_url: pdfPath\n            };\n\n            let result;\n            if (id) {\n                // UPDATE\n                result = await supabase\n                    .from('publications')\n                    .update(dataToSave)\n                    .eq('id', id);\n            } else {\n                // INSERT\n                // Add user_id so RLS allows it and we track ownership\n                result = await supabase\n                    .from('publications')\n                    .insert([{ ...dataToSave, user_id: user.id }]);\n            }\n\n            if (result.error) throw result.error;\n\n            alert(\"Publication sauvegard√©e avec succ√®s !\");\n\n            // Redirect based on role\n            const isAuthor = user.app_metadata?.role === 'author';\n            navigate(isAuthor ? '/author' : '/admin/content');\n\n        } catch (err) {\n            console.error(\"Error saving publication:\", err);\n            alert(\"Erreur lors de la sauvegarde : \" + err.message);\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const handleRequestValidation = async () => {\n        setLoading(true);\n\n        try {\n            // 1. Check if profile is complete\n            const { data: profile, error: profileError } = await supabase\n                .from('profiles')\n                .select('full_name, birth_date, birth_place, nationality, id_card_number, id_card_type, address, phone')\n                .eq('id', user.id)\n                .single();\n\n            if (profileError) throw profileError;\n\n            // 2. Validate required fields\n            const requiredFields = {\n                'Nom complet': profile.full_name,\n                'Date de naissance': profile.birth_date,\n                'Lieu de naissance': profile.birth_place,\n                'Nationalit√©': profile.nationality,\n                'Num√©ro de pi√®ce d\\'identit√©': profile.id_card_number,\n                'Type de pi√®ce d\\'identit√©': profile.id_card_type,\n                'Adresse': profile.address,\n                'T√©l√©phone': profile.phone\n            };\n\n            const missingFields = Object.entries(requiredFields)\n                .filter(([_, value]) => !value || value.trim() === '')\n                .map(([field, _]) => field);\n\n            if (missingFields.length > 0) {\n                setLoading(false);\n                const fieldsList = missingFields.join(', ');\n                alert(\n                    `‚ö†Ô∏è Profil incomplet !\\n\\n` +\n                    `Avant de soumettre votre manuscrit pour validation, vous devez compl√©ter les informations suivantes :\\n\\n` +\n                    `${fieldsList}\\n\\n` +\n                    `Vous allez √™tre redirig√© vers votre profil.`\n                );\n                navigate('/author/profile');\n                return;\n            }\n\n            // 3. If profile is complete, proceed with validation request\n            if (!confirm(\"Une fois la demande envoy√©e, vous ne pourrez plus modifier le manuscrit. Continuer ?\")) {\n                setLoading(false);\n                return;\n            }\n\n            const updates = {\n                position: 'en attente',\n                date_validation_request: new Date().toISOString()\n            };\n\n            const { error } = await supabase\n                .from('publications')\n                .update(updates)\n                .eq('id', id);\n\n            if (error) throw error;\n\n            alert(\"‚úÖ Demande de validation envoy√©e avec succ√®s !\");\n            navigate('/author');\n\n        } catch (err) {\n            console.error(err);\n            alert(\"Erreur : \" + err.message);\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const handleAdminValidation = async () => {\n        if (!confirm(\"Valider ce manuscrit ? Cela enregistrera la date de validation.\")) return;\n\n        setLoading(true);\n        try {\n            const updates = {\n                position: 'valid√©',\n                date_validation: new Date().toISOString()\n            };\n\n            const { error } = await supabase\n                .from('publications')\n                .update(updates)\n                .eq('id', id);\n\n            if (error) throw error;\n\n            alert(\"Manuscrit valid√© avec succ√®s !\");\n            navigate('/admin/content');\n            setFormData(prev => ({ ...prev, ...updates }));\n\n        } catch (err) {\n            console.error(err);\n            alert(\"Erreur : \" + err.message);\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const handlePrint = () => {\n        window.print();\n    };\n\n    // Check admin role for showing validation button\n    const isAdmin = user?.app_metadata?.role === 'admin';\n\n    return (\n        <div className=\"max-w-7xl mx-auto pb-10 print:pb-0\">\n            {/* Top Actions - Hidden on Print */}\n            <div className=\"flex justify-between items-center mb-6 print:hidden\">\n                <h1 className=\"text-2xl font-bold text-gray-800\">\n                    Fiche de la Publication\n                    {isLocked && <span className=\"ml-3 text-sm text-amber-600 bg-amber-50 px-3 py-1 rounded-full border border-amber-200\">üîí Lecture Seule (En attente de validation)</span>}\n                </h1>\n                <div className=\"flex gap-2\">\n                    {/* Admin Validation Button */}\n                    {isAdmin && id && (\n                        <button\n                            onClick={handleAdminValidation}\n                            className=\"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded shadow-sm text-sm font-medium flex items-center gap-2\"\n                        >\n                            <CheckCircle className=\"w-4 h-4\" /> Valider\n                        </button>\n                    )}\n\n                    {/* Print Button - Visible to EVERYONE (Author & Admin) */}\n                    <button\n                        onClick={handlePrint}\n                        className=\"bg-gray-100 hover:bg-gray-200 text-gray-700 px-4 py-2 rounded shadow-sm text-sm font-medium flex items-center gap-2\"\n                        title=\"Imprimer\"\n                    >\n                        <Printer className=\"w-4 h-4\" /> Imprimer\n                    </button>\n\n                    {!isLocked && (\n                        <button\n                            onClick={handleSubmit}\n                            disabled={loading}\n                            className=\"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded shadow-sm flex items-center gap-2 text-sm font-medium\"\n                        >\n                            <Save className=\"w-4 h-4\" /> Sauvegarder (Brouillon)\n                        </button>\n                    )}\n\n                    {/* Show Validation Request Button for Authors only if Draft */}\n                    {isAuthor && formData.position === 'en saisie' && id && (\n                        <button\n                            onClick={handleRequestValidation}\n                            className=\"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded shadow-sm text-sm font-medium\"\n                        >\n                            Envoyer pour Validation\n                        </button>\n                    )}\n\n                    <button\n                        onClick={() => navigate(isAuthor ? '/author' : '/admin/content')}\n                        className=\"bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded shadow-sm text-sm font-medium\"\n                    >\n                        Fermer\n                    </button>\n                </div>\n            </div>\n\n            <form className=\"grid grid-cols-1 lg:grid-cols-2 gap-8 print:hidden\" onSubmit={handleSubmit}>\n                <fieldset disabled={isLocked} className=\"contents\">\n\n                    {/* --- LEFT COLUMN --- */}\n                    <div className=\"space-y-4\">\n\n                        {/* Editor */}\n                        <div className=\"flex flex-col sm:grid sm:grid-cols-[120px_1fr] items-center gap-4\">\n                            <label className=\"font-bold text-gray-700\">√âditeur</label>\n                            <input\n                                name=\"editor_name\"\n                                value={formData.editor_name}\n                                onChange={handleChange}\n                                className=\"w-full bg-gray-100 border border-gray-300 rounded px-3 py-1.5\"\n                                disabled\n                            />\n                        </div>\n\n                        {/* Titles */}\n                        <div className=\"flex flex-col sm:grid sm:grid-cols-[120px_1fr] items-center gap-4\">\n                            <label className=\"font-bold text-gray-700\">Titre Principal *</label>\n                            <input\n                                name=\"title_main\"\n                                value={formData.title_main}\n                                onChange={handleChange}\n                                required\n                                className=\"w-full bg-white border-2 border-blue-500 rounded px-3 py-1.5 focus:outline-none\"\n                            />\n                        </div>\n                        <div className=\"flex flex-col sm:grid sm:grid-cols-[120px_1fr] items-center gap-4\">\n                            <label className=\"text-gray-500\">Titre secondaire</label>\n                            <input\n                                name=\"title_secondary\"\n                                value={formData.title_secondary}\n                                onChange={handleChange}\n                                className=\"w-full bg-white border border-blue-300 rounded px-3 py-1.5\"\n                            />\n                        </div>\n                        <div className=\"flex flex-col sm:grid sm:grid-cols-[120px_1fr] items-center gap-4\">\n                            <label className=\"text-gray-500\">Titre parall√®le</label>\n                            <input\n                                name=\"title_parallel\"\n                                value={formData.title_parallel}\n                                onChange={handleChange}\n                                className=\"w-full bg-white border border-blue-300 rounded px-3 py-1.5\"\n                            />\n                        </div>\n\n                        {/* Language */}\n                        <div className=\"flex flex-col sm:grid sm:grid-cols-[120px_1fr] items-center gap-4\">\n                            <label className=\"text-gray-500\">Langue</label>\n                            <select\n                                name=\"language\"\n                                value={formData.language}\n                                onChange={handleChange}\n                                className=\"w-40 bg-white border border-blue-300 rounded px-3 py-1.5\"\n                            >\n                                <option>Arabe</option>\n                                <option>Fran√ßais</option>\n                                <option>Anglais</option>\n                            </select>\n                        </div>\n\n                        {/* Publication Details */}\n                        <div className=\"space-y-2 mt-4\">\n                            <div className=\"flex flex-col sm:grid sm:grid-cols-[120px_1fr] items-center gap-4\">\n                                <label className=\"text-gray-500\">Publication :</label>\n                                <div className=\"flex gap-4 items-center w-full\">\n                                    <span className=\"text-gray-500 w-16\">√âditeur *</span>\n                                    <input\n                                        name=\"publisher_1\"\n                                        value={formData.publisher_1}\n                                        onChange={handleChange}\n                                        className=\"flex-1 bg-white border border-blue-300 rounded px-3 py-1.5\"\n                                    />\n                                </div>\n                            </div>\n                            <div className=\"flex flex-col sm:grid sm:grid-cols-[120px_1fr] items-center gap-4\">\n                                <div></div> {/* Spacer */}\n                                <div className=\"flex gap-4 items-center w-full\">\n                                    <span className=\"text-gray-500 w-16\">Lieu *</span>\n                                    <input\n                                        name=\"place_1\"\n                                        value={formData.place_1}\n                                        onChange={handleChange}\n                                        className=\"w-40 bg-white border border-blue-300 rounded px-3 py-1.5\"\n                                    />\n                                </div>\n                            </div>\n\n                            {/* Second Publisher Line */}\n                            <div className=\"flex flex-col sm:grid sm:grid-cols-[120px_1fr] items-center gap-4 mt-2\">\n                                <div></div> {/* Spacer */}\n                                <div className=\"flex gap-4 items-center w-full\">\n                                    <span className=\"text-gray-500 w-16\">√âditeur</span>\n                                    <input\n                                        name=\"publisher_2\"\n                                        value={formData.publisher_2}\n                                        onChange={handleChange}\n                                        className=\"flex-1 bg-white border border-blue-300 rounded px-3 py-1.5\"\n                                    />\n                                </div>\n                            </div>\n                            <div className=\"flex flex-col sm:grid sm:grid-cols-[120px_1fr] items-center gap-4\">\n                                <div></div> {/* Spacer */}\n                                <div className=\"flex gap-4 items-center w-full\">\n                                    <span className=\"text-gray-500 w-16\">Lieu</span>\n                                    <input\n                                        name=\"place_2\"\n                                        value={formData.place_2}\n                                        onChange={handleChange}\n                                        className=\"w-40 bg-white border border-blue-300 rounded px-3 py-1.5\"\n                                    />\n                                    <span className=\"text-gray-500 ml-2\">Ann√©e</span>\n                                    <input\n                                        name=\"publication_year\"\n                                        value={formData.publication_year}\n                                        onChange={handleChange}\n                                        className=\"w-24 bg-white border border-blue-300 rounded px-3 py-1.5\"\n                                    />\n                                </div>\n                            </div>\n                        </div>\n\n                        {/* Content Textareas */}\n                        <div className=\"flex flex-col sm:grid sm:grid-cols-[120px_1fr] gap-4 mt-4\">\n                            <label className=\"text-gray-500 mt-2\">Sommaire *</label>\n                            <textarea\n                                name=\"summary\"\n                                value={formData.summary}\n                                onChange={handleChange}\n                                rows={4}\n                                className=\"w-full bg-white border border-blue-300 rounded px-3 py-2\"\n                            ></textarea>\n                        </div>\n                        <div className=\"flex flex-col sm:grid sm:grid-cols-[120px_1fr] gap-4\">\n                            <label className=\"text-gray-500 mt-2\">R√©sum√© *</label>\n                            <textarea\n                                name=\"abstract\"\n                                value={formData.abstract}\n                                onChange={handleChange}\n                                rows={4}\n                                className=\"w-full bg-white border border-blue-300 rounded px-3 py-2\"\n                            ></textarea>\n                        </div>\n                        <div className=\"flex flex-col sm:grid sm:grid-cols-[120px_1fr] gap-4\">\n                            <label className=\"text-gray-500 mt-2\">Mots Cl√©s *</label>\n                            <textarea\n                                name=\"keywords\"\n                                value={formData.keywords}\n                                onChange={handleChange}\n                                rows={2}\n                                className=\"w-full bg-white border border-blue-300 rounded px-3 py-2\"\n                            ></textarea>\n                        </div>\n\n                        {/* --- FILES UPLOAD --- */}\n                        <div className=\"mt-6 border-t pt-4 border-gray-100\">\n                            <h3 className=\"font-bold text-gray-800 mb-4 flex items-center gap-2\">\n                                <Upload className=\"w-5 h-5 text-note-purple\" />\n                                Fichiers du Manuscrit\n                            </h3>\n\n                            <div className=\"space-y-4\">\n                                {/* DOC/DOCX */}\n                                <div className=\"flex flex-col sm:grid sm:grid-cols-[120px_1fr] items-center gap-4\">\n                                    <label className=\"font-bold text-gray-700\">Format Word</label>\n                                    <div className=\"flex items-center gap-3\">\n                                        <input\n                                            type=\"file\"\n                                            accept=\".doc,.docx\"\n                                            onChange={(e) => handleFileChange(e, 'doc')}\n                                            className=\"block w-full text-sm text-gray-500\n                                                file:mr-4 file:py-2 file:px-4\n                                                file:rounded-full file:border-0\n                                                file:text-sm file:font-semibold\n                                                file:bg-blue-50 file:text-blue-700\n                                                hover:file:bg-blue-100\"\n                                            disabled={isLocked}\n                                        />\n                                        {formData.file_doc_url && (\n                                            <a\n                                                href=\"#\"\n                                                onClick={(e) => { e.preventDefault(); downloadFile(formData.file_doc_url, 'doc'); }}\n                                                className=\"text-sm text-blue-600 underline whitespace-nowrap\"\n                                            >\n                                                Voir fichier actuel\n                                            </a>\n                                        )}\n                                    </div>\n                                </div>\n\n                                {/* PDF */}\n                                <div className=\"flex flex-col sm:grid sm:grid-cols-[120px_1fr] items-center gap-4\">\n                                    <label className=\"font-bold text-gray-700\">Format PDF</label>\n                                    <div className=\"flex items-center gap-3\">\n                                        <input\n                                            type=\"file\"\n                                            accept=\".pdf\"\n                                            onChange={(e) => handleFileChange(e, 'pdf')}\n                                            className=\"block w-full text-sm text-gray-500\n                                                file:mr-4 file:py-2 file:px-4\n                                                file:rounded-full file:border-0\n                                                file:text-sm file:font-semibold\n                                                file:bg-red-50 file:text-red-700\n                                                hover:file:bg-red-100\"\n                                            disabled={isLocked}\n                                        />\n                                        {formData.file_pdf_url && (\n                                            <a\n                                                href=\"#\"\n                                                onClick={(e) => { e.preventDefault(); downloadFile(formData.file_pdf_url, 'pdf'); }}\n                                                className=\"text-sm text-red-600 underline whitespace-nowrap\"\n                                            >\n                                                Voir fichier actuel\n                                            </a>\n                                        )}\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n\n                    </div>\n\n                    {/* --- RIGHT COLUMN --- */}\n                    <div className=\"space-y-4 border-l pl-8 border-gray-100\">\n\n                        {/* ISBN */}\n                        <div className=\"flex flex-col sm:grid sm:grid-cols-[120px_1fr] items-center gap-4\">\n                            <label className=\"font-bold text-gray-800\">ISBN</label>\n                            <input\n                                name=\"isbn\"\n                                value={formData.isbn}\n                                onChange={handleChange}\n                                className=\"w-64 bg-white border border-blue-300 rounded px-3 py-1.5 bg-blue-50\"\n                            />\n                        </div>\n\n                        {/* Position - Only Admin can see/edit, OR Author can see but readonly?\n                        The requirement says Author should not validate. Let's make it read-only or hidden.\n                        Let's show it read-only for feedback.\n                    */}\n                        <div className=\"flex flex-col sm:grid sm:grid-cols-[120px_1fr] items-center gap-4\">\n                            <label className=\"font-bold text-gray-800\">Position</label>\n                            <input\n                                name=\"position\"\n                                value={formData.position}\n                                onChange={handleChange}\n                                className={`w-64 bg-gray-100 border border-blue-300 rounded px-3 py-1.5 ${user?.app_metadata?.role === 'author' ? 'opacity-70 cursor-not-allowed' : ''}`}\n                                // Disable if author to prevent them forcing it?\n                                // Actually RLS \"Authors can update own\" should probably restrict this column,\n                                // but UI disabling is good first step.\n                                disabled={user?.app_metadata?.role === 'author'}\n                            />\n                        </div>\n\n                        {/* Dates Display */}\n                        <div className=\"ml-[136px] text-sm text-gray-600 space-y-1 mb-6 p-4 bg-gray-50 rounded-lg border border-gray-100\">\n                            <div className=\"flex justify-between w-64\">\n                                <span>Cr√©ation :</span>\n                                <span className=\"font-bold\">{formData.created_at ? new Date(formData.created_at).toLocaleDateString() : '-'}</span>\n                            </div>\n                            <div className=\"flex justify-between w-64\">\n                                <span>Demande validation :</span>\n                                <span className={formData.date_validation_request ? \"font-semibold text-blue-600\" : \"\"}>\n                                    {formData.date_validation_request ? new Date(formData.date_validation_request).toLocaleDateString() : '-'}\n                                </span>\n                            </div>\n                            <div className=\"flex justify-between w-64\">\n                                <span>Validation Admin :</span>\n                                <span className={formData.date_validation ? \"font-semibold text-green-600\" : \"\"}>\n                                    {formData.date_validation ? new Date(formData.date_validation).toLocaleDateString() : '-'}\n                                </span>\n                            </div>\n                            <div className=\"flex justify-between w-64\">\n                                <span>Date ISBN :</span>\n                                <span>{formData.date_isbn ? new Date(formData.date_isbn).toLocaleDateString() : '-'}</span>\n                            </div>\n                            <div className=\"flex justify-between w-64\">\n                                <span>D√©p√¥t L√©gal :</span>\n                                <span>{formData.date_depot ? new Date(formData.date_depot).toLocaleDateString() : '-'}</span>\n                            </div>\n                        </div>\n\n                        {/* Collection */}\n                        <div className=\"flex flex-col sm:grid sm:grid-cols-[120px_1fr] items-center gap-4\">\n                            <label className=\"text-gray-500\">Collection :</label>\n                            <div className=\"w-full space-y-2\">\n                                <div className=\"flex items-center gap-4\">\n                                    <span className=\"text-gray-500 w-16\">Titre</span>\n                                    <input\n                                        name=\"collection_title\"\n                                        value={formData.collection_title}\n                                        onChange={handleChange}\n                                        className=\"flex-1 bg-white border border-blue-300 rounded px-3 py-1.5\"\n                                    />\n                                </div>\n                                <div className=\"flex items-center gap-4\">\n                                    <span className=\"text-gray-500 w-16\">Num√©ro</span>\n                                    <input\n                                        name=\"collection_number\"\n                                        value={formData.collection_number}\n                                        onChange={handleChange}\n                                        className=\"w-24 bg-white border border-blue-300 rounded px-3 py-1.5\"\n                                    />\n                                </div>\n                            </div>\n                        </div>\n\n                        {/* Authors */}\n                        <div className=\"flex flex-col sm:grid sm:grid-cols-[120px_1fr] gap-4 mt-6\">\n                            <label className=\"text-gray-500 mt-2\">Auteur principal :</label>\n                            <div className=\"w-full space-y-2\">\n                                <div className=\"flex items-center gap-4\">\n                                    <span className=\"text-gray-500 w-16\">Nom *</span>\n                                    <input\n                                        name=\"main_author_name\"\n                                        value={formData.main_author_name}\n                                        onChange={handleChange}\n                                        className=\"flex-1 bg-white border border-blue-300 rounded px-3 py-1.5\"\n                                    />\n                                </div>\n                                <div className=\"flex items-center gap-4\">\n                                    <span className=\"text-gray-500 w-16\">Pr√©nom *</span>\n                                    <input\n                                        name=\"main_author_firstname\"\n                                        value={formData.main_author_firstname}\n                                        onChange={handleChange}\n                                        className=\"flex-1 bg-white border border-blue-300 rounded px-3 py-1.5\"\n                                    />\n                                </div>\n                            </div>\n                        </div>\n\n                        {/* Second Author */}\n                        <div className=\"flex flex-col sm:grid sm:grid-cols-[120px_1fr] gap-4 mt-4\">\n                            <label className=\"text-gray-500 mt-2\">Auteur :</label>\n                            <div className=\"w-full space-y-2\">\n                                <div className=\"flex items-center gap-4\">\n                                    <span className=\"text-gray-500 w-16\">Nom</span>\n                                    <input\n                                        name=\"author_2_name\"\n                                        value={formData.author_2_name}\n                                        onChange={handleChange}\n                                        className=\"flex-1 bg-white border border-blue-300 rounded px-3 py-1.5\"\n                                    />\n                                </div>\n                                <div className=\"flex items-center gap-4\">\n                                    <span className=\"text-gray-500 w-16\">Pr√©nom</span>\n                                    <input\n                                        name=\"author_2_firstname\"\n                                        value={formData.author_2_firstname}\n                                        onChange={handleChange}\n                                        className=\"flex-1 bg-white border border-blue-300 rounded px-3 py-1.5\"\n                                    />\n                                </div>\n                                <div className=\"flex items-center gap-4\">\n                                    <span className=\"text-gray-500 w-16\">Fonction</span>\n                                    <select\n                                        name=\"author_2_role\"\n                                        value={formData.author_2_role}\n                                        onChange={handleChange}\n                                        className=\"flex-1 bg-white border border-blue-300 rounded px-3 py-1.5\"\n                                    >\n                                        <option>Pr√©paration</option>\n                                        <option>Traduction</option>\n                                        <option>Illustration</option>\n                                    </select>\n                                </div>\n                            </div>\n                        </div>\n\n                        {/* Description */}\n                        <div className=\"flex flex-col sm:grid sm:grid-cols-[120px_1fr] gap-4 mt-8\">\n                            <label className=\"text-gray-500 mt-2\">Description :</label>\n                            <div className=\"w-full space-y-2\">\n                                <div className=\"flex items-center gap-4\">\n                                    <span className=\"text-gray-500 w-32\">Nombre de pages</span>\n                                    <input\n                                        name=\"page_count\"\n                                        value={formData.page_count}\n                                        onChange={handleChange}\n                                        className=\"flex-1 bg-white border border-blue-300 rounded px-3 py-1.5\"\n                                    />\n                                </div>\n                                <div className=\"flex items-center gap-4\">\n                                    <span className=\"text-gray-500 w-32\">Illustrations</span>\n                                    <input\n                                        name=\"illustrations\"\n                                        value={formData.illustrations}\n                                        onChange={handleChange}\n                                        className=\"flex-1 bg-white border border-blue-300 rounded px-3 py-1.5\"\n                                    />\n                                </div>\n                                <div className=\"flex items-center gap-4\">\n                                    <span className=\"text-gray-500 w-32\">Nombre de tomes</span>\n                                    <input\n                                        name=\"volume_count\"\n                                        value={formData.volume_count}\n                                        onChange={handleChange}\n                                        className=\"flex-1 bg-white border border-blue-300 rounded px-3 py-1.5\"\n                                    />\n                                </div>\n                                <div className=\"flex items-center gap-4\">\n                                    <span className=\"text-gray-500 w-32\">Format</span>\n                                    <input\n                                        name=\"format\"\n                                        value={formData.format}\n                                        onChange={handleChange}\n                                        className=\"flex-1 bg-white border border-blue-300 rounded px-3 py-1.5\"\n                                    />\n                                </div>\n                            </div>\n                        </div>\n\n                    </div>\n                </fieldset>\n            </form>\n\n            {/* --- PRINT TEMPLATE (Visible only when printing) --- */}\n            <div className=\"hidden print:block font-serif text-black p-8 max-w-[210mm] mx-auto bg-white\">\n                {/* Header */}\n                <div className=\"flex justify-between items-end border-b-2 border-black pb-4 mb-8\">\n                    <div>\n                        <h1 className=\"text-4xl font-bold font-sans text-note-purple mb-1\">Note.dz</h1>\n                        <p className=\"text-sm text-gray-600\">Plateforme d'√©dition num√©rique</p>\n                    </div>\n                    <div className=\"text-right\">\n                        <h2 className=\"text-xl font-bold uppercase tracking-wider\">Fiche Manuscrit</h2>\n                        <p className=\"text-sm mt-1\">Ref: {id ? id.split('-')[0] : 'N/A'}</p>\n                        <p className=\"text-sm\">Imprim√© le : {new Date().toLocaleDateString()}</p>\n                    </div>\n                </div>\n\n                {/* Status Badge */}\n                <div className=\"mb-6 flex justify-end\">\n                    <span className=\"border border-black px-3 py-1 text-sm font-bold uppercase rounded\">\n                        Statut : {formData.position}\n                    </span>\n                </div>\n\n                {/* Main Info */}\n                <div className=\"grid grid-cols-1 gap-6 mb-8\">\n                    <div className=\"border border-black p-4\">\n                        <h3 className=\"font-bold border-b border-black mb-3 pb-1 uppercase text-sm\">Identification</h3>\n                        <div className=\"grid grid-cols-[150px_1fr] gap-y-2 text-sm\">\n                            <span className=\"font-bold\">Titre Principal :</span>\n                            <span className=\"text-lg font-bold\">{formData.title_main}</span>\n\n                            <span className=\"font-bold\">Titre Secondaire :</span>\n                            <span>{formData.title_secondary || '-'}</span>\n\n                            <span className=\"font-bold\">ISBN :</span>\n                            <span className=\"font-mono\">{formData.isbn || 'Non attribu√©'}</span>\n\n                            <span className=\"font-bold\">Langue :</span>\n                            <span>{formData.language}</span>\n\n                            <span className=\"font-bold\">Collection :</span>\n                            <span>{formData.collection_title ? `${formData.collection_title} (N¬∞${formData.collection_number})` : '-'}</span>\n                        </div>\n                    </div>\n\n                    <div className=\"border border-black p-4\">\n                        <h3 className=\"font-bold border-b border-black mb-3 pb-1 uppercase text-sm\">Auteurs</h3>\n                        <div className=\"grid grid-cols-[150px_1fr] gap-y-2 text-sm\">\n                            <span className=\"font-bold\">Auteur Principal :</span>\n                            <span className=\"uppercase\">{formData.main_author_name} {formData.main_author_firstname}</span>\n\n                            {formData.author_2_name && (\n                                <>\n                                    <span className=\"font-bold\">Auteur Secondaire :</span>\n                                    <span>{formData.author_2_name} {formData.author_2_firstname} ({formData.author_2_role})</span>\n                                </>\n                            )}\n\n                            <span className=\"font-bold\">√âditeur :</span>\n                            <span>{formData.editor_name}</span>\n                        </div>\n                    </div>\n\n                    <div className=\"border border-black p-4\">\n                        <h3 className=\"font-bold border-b border-black mb-3 pb-1 uppercase text-sm\">D√©tails Techniques</h3>\n                        <div className=\"grid grid-cols-2 gap-4 text-sm\">\n                            <div className=\"grid grid-cols-[100px_1fr] gap-y-1\">\n                                <span className=\"font-bold\">Format :</span> <span>{formData.format || '-'}</span>\n                                <span className=\"font-bold\">Pages :</span> <span>{formData.page_count || '-'}</span>\n                            </div>\n                            <div className=\"grid grid-cols-[100px_1fr] gap-y-1\">\n                                <span className=\"font-bold\">Volumes :</span> <span>{formData.volume_count || '-'}</span>\n                                <span className=\"font-bold\">Illustrations :</span> <span>{formData.illustrations || '-'}</span>\n                            </div>\n                        </div>\n                    </div>\n\n                    <div className=\"border border-black p-4\">\n                        <h3 className=\"font-bold border-b border-black mb-3 pb-1 uppercase text-sm\">Contenu</h3>\n                        <div className=\"space-y-4 text-sm\">\n                            <div>\n                                <span className=\"font-bold block mb-1\">R√©sum√© :</span>\n                                <p className=\"text-justify leading-relaxed\">{formData.abstract || '-'}</p>\n                            </div>\n                            <div>\n                                <span className=\"font-bold block mb-1\">Sommaire :</span>\n                                <p className=\"whitespace-pre-line text-xs\">{formData.summary || '-'}</p>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n\n                {/* Footer Validation */}\n                <div className=\"mt-12 pt-4 border-t-2 border-black grid grid-cols-2 gap-8 text-sm\">\n                    <div>\n                        <p className=\"font-bold mb-8\">Signature Auteur :</p>\n                        <div className=\"h-0.5 w-32 bg-black\"></div>\n                    </div>\n                    <div>\n                        <p className=\"font-bold mb-2\">Validation Administration :</p>\n                        <p>Date : {formData.date_validation ? new Date(formData.date_validation).toLocaleDateString() : 'En attente'}</p>\n                        <p>D√©p√¥t L√©gal : {formData.date_depot ? new Date(formData.date_depot).toLocaleDateString() : '-'}</p>\n                    </div>\n                </div>\n            </div>\n        </div >\n    );\n};\n\nexport default PublicationForm;\n","usedDeprecatedRules":[]},{"filePath":"/Users/mac/Desktop/akouass/note/site de publising/site 1 /src/pages/admin/UserDetails.jsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchUserProfile'. Either include it or remove the dependency array.","line":52,"column":8,"nodeType":"ArrayExpression","endLine":52,"endColumn":12,"suggestions":[{"desc":"Update the dependencies array to be: [fetchUserProfile, id]","fix":{"range":[1537,1541],"text":"[fetchUserProfile, id]"}}]},{"ruleId":"no-undef","severity":2,"message":"'fetchProfile' is not defined.","line":142,"column":23,"nodeType":"Identifier","messageId":"undef","endLine":142,"endColumn":35}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport { supabase } from '../../supabaseClient';\nimport { ArrowLeft, Save, Mail, Shield, User, Clock, Calendar, Briefcase, GraduationCap, Book, Globe } from 'lucide-react';\n\nconst UserDetails = () => {\n    const { id } = useParams();\n    const navigate = useNavigate();\n\n    const [profile, setProfile] = useState(null);\n    const [loading, setLoading] = useState(true);\n    const [updating, setUpdating] = useState(false);\n    const [error, setError] = useState(null);\n\n    // Consolidated Form State\n    const [formData, setFormData] = useState({\n        full_name: '',\n        role: 'author',\n        birth_date: '',\n        birth_place: '',\n        nationality: '',\n        id_card_number: '',\n        id_card_type: 'CNI',\n        address: '',\n        phone: '',\n        profession: '',\n        professional_status: '',\n        employer: '',\n        activity_field: '',\n        experience_years: '',\n        last_degree: '',\n        specialty: '',\n        university: '',\n        degree_year: '',\n        high_school_level: '',\n        high_school_name: '',\n        bac_year: '',\n        has_published: false,\n        published_works: '',\n        literary_genres: '',\n        writing_languages: '',\n        social_facebook: '',\n        social_instagram: '',\n        social_twitter: '',\n        social_linkedin: '',\n        social_youtube: '',\n        website: ''\n    });\n\n    useEffect(() => {\n        fetchUserProfile();\n    }, [id]);\n\n    const fetchUserProfile = async () => {\n        setLoading(true);\n        try {\n            const { data, error } = await supabase\n                .from('profiles')\n                .select('*')\n                .eq('id', id)\n                .single();\n\n            if (error) throw error;\n\n            setProfile(data);\n\n            // Sync form data with DB data, ensuring no nulls and handling arrays\n            const initialData = {};\n            Object.keys(formData).forEach(key => {\n                let val = data[key];\n                // Handle array fields: Convert to comma-separated string for UI\n                if (Array.isArray(val)) {\n                    val = val.join(', ');\n                }\n\n                // Provide defaults for specific fields if they are null in DB\n                if (key === 'id_card_type' && !val) val = 'CNI';\n\n                initialData[key] = val ?? (key === 'has_published' ? false : '');\n            });\n            setFormData(initialData);\n\n        } catch (err) {\n            console.error(\"Error fetching profile:\", err);\n            setError(\"Impossible de charger le profil. L'utilisateur n'existe peut-√™tre pas.\");\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const handleInputChange = (e) => {\n        const { name, value, type, checked } = e.target;\n        setFormData(prev => ({\n            ...prev,\n            [name]: type === 'checkbox' ? checked : value\n        }));\n    };\n\n    const handleSave = async () => {\n        setUpdating(true);\n        try {\n            // Prepare updates: Convert specific strings back to arrays for Supabase\n            const updates = { ...formData };\n\n            // 1. Explicit Array Fields\n            const arrayFields = ['literary_genres', 'writing_languages'];\n            arrayFields.forEach(field => {\n                if (typeof updates[field] === 'string') {\n                    const str = updates[field].trim();\n                    updates[field] = str ? str.split(',').map(s => s.trim()).filter(Boolean) : null;\n                }\n            });\n\n            // 2. Dynamic Safety: Convert ANY remaining empty strings to NULL\n            const sanitizedData = Object.keys(updates).reduce((acc, key) => {\n                const val = updates[key];\n                // Exception: id_card_type should stay 'CNI' or 'Passeport', never null/empty if possible\n                if (key === 'id_card_type' && !val) {\n                    acc[key] = 'CNI';\n                } else {\n                    acc[key] = (val === '') ? null : val;\n                }\n                return acc;\n            }, {});\n\n            console.log(\"UserDetails: Sending sanitized data:\", sanitizedData);\n\n            const { error } = await supabase\n                .from('profiles')\n                .update({\n                    ...sanitizedData,\n                    updated_at: new Date()\n                })\n                .eq('id', id);\n\n            if (error) throw error;\n\n            alert(\"Profil mis √† jour avec succ√®s !\");\n\n            // Safety check for fetchProfile (it might not be available in all contexts)\n            if (typeof fetchProfile === 'function') {\n                await fetchProfile({ id }); // Note: UserDetails might be editing *another* user\n            }\n        } catch (err) {\n            console.error(\"Error updating profile:\", err);\n            alert(\"Erreur lors de la mise √† jour : \" + err.message);\n        } finally {\n            setUpdating(false);\n        }\n    };\n\n    const handlePasswordReset = async () => {\n        if (!confirm(`Envoyer un email de r√©initialisation de mot de passe √† ${profile.email} ?`)) return;\n\n        try {\n            const { error } = await supabase.auth.resetPasswordForEmail(profile.email, {\n                redirectTo: `${window.location.origin}/update-password`,\n            });\n\n            if (error) throw error;\n            alert(`Email envoy√© √† ${profile.email} !`);\n        } catch (err) {\n            console.error(\"Error sending reset email:\", err);\n            if (err.message.includes(\"rate limit\")) {\n                alert(\"Trop de tentatives. Veuillez patienter quelques minutes avant de r√©essayer.\");\n            } else {\n                alert(\"Erreur lors de l'envoi : \" + err.message);\n            }\n        }\n    };\n\n    if (loading) return <div className=\"p-8 text-center text-gray-500\">Chargement du profil...</div>;\n    if (error) return (\n        <div className=\"p-8 flex flex-col items-center\">\n            <div className=\"text-red-500 mb-4\">{error}</div>\n            <button onClick={() => navigate('/admin/users')} className=\"text-note-purple hover:underline\">\n                Retour √† la liste\n            </button>\n        </div>\n    );\n\n    return (\n        <div className=\"max-w-3xl mx-auto\">\n            {/* Header */}\n            <div className=\"mb-8 flex items-center gap-4\">\n                <button\n                    onClick={() => navigate('/admin/users')}\n                    className=\"p-2 rounded-full hover:bg-gray-100 text-gray-500 transition-colors\"\n                >\n                    <ArrowLeft className=\"w-5 h-5\" />\n                </button>\n                <div>\n                    <h1 className=\"text-2xl font-bold text-gray-800\">D√©tails Utilisateur</h1>\n                    <p className=\"text-gray-500 text-sm\">Gestion du profil de {profile.email}</p>\n                </div>\n            </div>\n\n            {/* Main Content */}\n            <div className=\"bg-white rounded-2xl border border-gray-200 shadow-sm overflow-hidden\">\n                {/* ID Card Header */}\n                <div className=\"bg-gray-50 p-6 border-b border-gray-200 flex flex-col md:flex-row md:items-center justify-between gap-4\">\n                    <div className=\"flex items-center gap-4\">\n                        <div className=\"w-16 h-16 rounded-full bg-violet-100 flex items-center justify-center text-note-purple font-bold text-2xl\">\n                            {(formData.full_name || profile.email).charAt(0).toUpperCase()}\n                        </div>\n                        <div>\n                            <h2 className=\"text-xl font-bold text-gray-900\">{profile.email}</h2>\n                            <div className=\"flex items-center gap-2 text-xs text-gray-500 font-mono mt-1\">\n                                <span>ID: {profile.id}</span>\n                            </div>\n                        </div>\n                    </div>\n                    <div className=\"flex flex-col items-end gap-1 text-xs text-gray-500\">\n                        <div className=\"flex items-center gap-1\">\n                            <Calendar className=\"w-3 h-3\" />\n                            Inscrit le : {new Date(profile.created_at).toLocaleDateString()}\n                        </div>\n                        {/* Note: Supabase doesn't expose last_sign_in in public table by default without trigger */}\n                    </div>\n                </div>\n\n                {/* Edit Form */}\n                <div className=\"p-8 space-y-8\">\n\n                    {/* Basic & Account */}\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 mb-1\">Nom Complet</label>\n                            <div className=\"relative group\">\n                                <User className=\"absolute left-3 top-2.5 h-5 w-5 text-gray-400 group-focus-within:text-note-purple\" />\n                                <input\n                                    type=\"text\"\n                                    name=\"full_name\"\n                                    value={formData.full_name}\n                                    onChange={handleInputChange}\n                                    className=\"w-full bg-gray-50 border border-gray-200 rounded-lg py-2 pl-10 pr-4 focus:ring-2 focus:ring-note-purple/20 focus:border-note-purple outline-none transition-all\"\n                                    placeholder=\"Nom complet\"\n                                />\n                            </div>\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 mb-1\">R√¥le Syst√®me</label>\n                            <div className=\"relative group\">\n                                <Shield className=\"absolute left-3 top-2.5 h-5 w-5 text-gray-400 group-focus-within:text-note-purple\" />\n                                <select\n                                    name=\"role\"\n                                    value={formData.role}\n                                    onChange={handleInputChange}\n                                    className=\"w-full bg-gray-50 border border-gray-200 rounded-lg py-2 pl-10 pr-4 focus:ring-2 focus:ring-note-purple/20 focus:border-note-purple outline-none appearance-none transition-all\"\n                                >\n                                    <option value=\"author\">Auteur (Standard)</option>\n                                    <option value=\"admin\">Administrateur (Acc√®s complet)</option>\n                                </select>\n                            </div>\n                        </div>\n                    </div>\n\n                    {/* Section: Informations Personnelles */}\n                    <div className=\"pt-6 border-t border-gray-100\">\n                        <h3 className=\"text-lg font-bold text-gray-800 mb-4 flex items-center gap-2\">\n                            <User className=\"w-5 h-5 text-blue-500\" />\n                            Informations Personnelles\n                        </h3>\n                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                            <div>\n                                <label className=\"block text-xs font-bold text-gray-400 uppercase mb-1\">Date de naissance</label>\n                                <input type=\"date\" name=\"birth_date\" value={formData.birth_date} onChange={handleInputChange} className=\"w-full bg-gray-50 border border-gray-200 rounded-lg py-2 px-3 text-sm focus:border-note-purple outline-none\" />\n                            </div>\n                            <div>\n                                <label className=\"block text-xs font-bold text-gray-400 uppercase mb-1\">Lieu de naissance</label>\n                                <input name=\"birth_place\" value={formData.birth_place} onChange={handleInputChange} className=\"w-full bg-gray-50 border border-gray-200 rounded-lg py-2 px-3 text-sm focus:border-note-purple outline-none\" />\n                            </div>\n                            <div>\n                                <label className=\"block text-xs font-bold text-gray-400 uppercase mb-1\">Nationalit√©</label>\n                                <input name=\"nationality\" value={formData.nationality} onChange={handleInputChange} className=\"w-full bg-gray-50 border border-gray-200 rounded-lg py-2 px-3 text-sm focus:border-note-purple outline-none\" />\n                            </div>\n                            <div>\n                                <label className=\"block text-xs font-bold text-gray-400 uppercase mb-1\">T√©l√©phone</label>\n                                <input name=\"phone\" value={formData.phone} onChange={handleInputChange} className=\"w-full bg-gray-50 border border-gray-200 rounded-lg py-2 px-3 text-sm focus:border-note-purple outline-none\" />\n                            </div>\n                            <div className=\"md:col-span-2\">\n                                <label className=\"block text-xs font-bold text-gray-400 uppercase mb-1\">Adresse</label>\n                                <input name=\"address\" value={formData.address} onChange={handleInputChange} className=\"w-full bg-gray-50 border border-gray-200 rounded-lg py-2 px-3 text-sm focus:border-note-purple outline-none\" />\n                            </div>\n                        </div>\n                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4 bg-gray-50 p-4 rounded-xl\">\n                            <div>\n                                <label className=\"block text-xs font-bold text-gray-400 uppercase mb-1\">Type d'identit√©</label>\n                                <div className=\"space-y-1\">\n                                    <select\n                                        name=\"id_card_type_select\"\n                                        value={['CNI', 'Permis de conduire', 'Passeport'].includes(formData.id_card_type) ? formData.id_card_type : 'Autre'}\n                                        onChange={(e) => {\n                                            const val = e.target.value;\n                                            if (val !== 'Autre') {\n                                                setFormData(prev => ({ ...prev, id_card_type: val }));\n                                            } else {\n                                                if (['CNI', 'Permis de conduire', 'Passeport'].includes(formData.id_card_type)) {\n                                                    setFormData(prev => ({ ...prev, id_card_type: '' }));\n                                                }\n                                            }\n                                        }}\n                                        className=\"w-full bg-white border border-gray-200 rounded-lg py-2 px-3 text-sm focus:border-note-purple outline-none\"\n                                    >\n                                        <option value=\"CNI\">Carte Nationale</option>\n                                        <option value=\"Permis de conduire\">Permis de conduire</option>\n                                        <option value=\"Passeport\">Passeport</option>\n                                        <option value=\"Autre\">Autre (Pr√©ciser)</option>\n                                    </select>\n\n                                    {!['CNI', 'Permis de conduire', 'Passeport'].includes(formData.id_card_type) && (\n                                        <input\n                                            type=\"text\"\n                                            name=\"id_card_type\"\n                                            value={formData.id_card_type}\n                                            onChange={handleInputChange}\n                                            placeholder=\"Pr√©cisez...\"\n                                            className=\"w-full bg-white border border-gray-200 rounded-lg py-2 px-3 text-sm focus:border-note-purple outline-none animate-in fade-in slide-in-from-top-1\"\n                                        />\n                                    )}\n                                </div>\n                            </div>\n                            <div>\n                                <label className=\"block text-xs font-bold text-gray-400 uppercase mb-1\">Num√©ro d'identit√©</label>\n                                <input name=\"id_card_number\" value={formData.id_card_number} onChange={handleInputChange} className=\"w-full bg-white border border-gray-200 rounded-lg py-2 px-3 text-sm focus:border-note-purple outline-none\" />\n                            </div>\n                            {profile.id_card_url && (\n                                <div className=\"md:col-span-2 mt-2\">\n                                    <span className=\"text-xs text-gray-500 block mb-1\">Document d'identit√© :</span>\n                                    <a href={`${supabase.storage.from('identity_documents').getPublicUrl(profile.id_card_url).data.publicUrl}`} target=\"_blank\" rel=\"noreferrer\" className=\"text-note-purple text-sm hover:underline font-medium\">üìÑ Afficher le scan</a>\n                                </div>\n                            )}\n                        </div>\n                    </div>\n\n                    {/* Section: Parcours Professionnel */}\n                    <div className=\"pt-6 border-t border-gray-100\">\n                        <h3 className=\"text-lg font-bold text-gray-800 mb-4 flex items-center gap-2\">\n                            <Briefcase className=\"w-5 h-5 text-amber-500\" />\n                            Parcours Professionnel\n                        </h3>\n                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                            <div>\n                                <label className=\"block text-xs font-bold text-gray-400 uppercase mb-1\">Profession</label>\n                                <input name=\"profession\" value={formData.profession} onChange={handleInputChange} className=\"w-full bg-gray-50 border border-gray-200 rounded-lg py-2 px-3 text-sm focus:border-note-purple outline-none\" />\n                            </div>\n                            <div>\n                                <label className=\"block text-xs font-bold text-gray-400 uppercase mb-1\">Statut</label>\n                                <input name=\"professional_status\" value={formData.professional_status} onChange={handleInputChange} className=\"w-full bg-gray-50 border border-gray-200 rounded-lg py-2 px-3 text-sm focus:border-note-purple outline-none\" />\n                            </div>\n                            <div>\n                                <label className=\"block text-xs font-bold text-gray-400 uppercase mb-1\">Employeur</label>\n                                <input name=\"employer\" value={formData.employer} onChange={handleInputChange} className=\"w-full bg-gray-50 border border-gray-200 rounded-lg py-2 px-3 text-sm focus:border-note-purple outline-none\" />\n                            </div>\n                            <div>\n                                <label className=\"block text-xs font-bold text-gray-400 uppercase mb-1\">Exp√©rience (ann√©es)</label>\n                                <input type=\"number\" name=\"experience_years\" value={formData.experience_years} onChange={handleInputChange} className=\"w-full bg-gray-50 border border-gray-200 rounded-lg py-2 px-3 text-sm focus:border-note-purple outline-none\" />\n                            </div>\n                        </div>\n                    </div>\n\n                    {/* Section: Parcours Acad√©mique */}\n                    <div className=\"pt-6 border-t border-gray-100\">\n                        <h3 className=\"text-lg font-bold text-gray-800 mb-4 flex items-center gap-2\">\n                            <GraduationCap className=\"w-5 h-5 text-purple-500\" />\n                            Parcours Acad√©mique\n                        </h3>\n                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                            <div>\n                                <label className=\"block text-xs font-bold text-gray-400 uppercase mb-1\">Dernier dipl√¥me</label>\n                                <input name=\"last_degree\" value={formData.last_degree} onChange={handleInputChange} className=\"w-full bg-gray-50 border border-gray-200 rounded-lg py-2 px-3 text-sm focus:border-note-purple outline-none\" />\n                            </div>\n                            <div>\n                                <label className=\"block text-xs font-bold text-gray-400 uppercase mb-1\">Universit√©</label>\n                                <input name=\"university\" value={formData.university} onChange={handleInputChange} className=\"w-full bg-gray-50 border border-gray-200 rounded-lg py-2 px-3 text-sm focus:border-note-purple outline-none\" />\n                            </div>\n                        </div>\n                    </div>\n\n                    {/* Section: Exp√©rience Litt√©raire */}\n                    <div className=\"pt-6 border-t border-gray-100\">\n                        <h3 className=\"text-lg font-bold text-gray-800 mb-4 flex items-center gap-2\">\n                            <Book className=\"w-5 h-5 text-red-500\" />\n                            Exp√©rience Litt√©raire\n                        </h3>\n                        <div className=\"space-y-4\">\n                            <div className=\"flex items-center gap-2\">\n                                <input type=\"checkbox\" name=\"has_published\" checked={formData.has_published} onChange={handleInputChange} className=\"w-4 h-4 accent-note-purple\" />\n                                <label className=\"text-sm text-gray-700\">A d√©j√† publi√© des ouvrages</label>\n                            </div>\n                            {formData.has_published && (\n                                <div>\n                                    <label className=\"block text-xs font-bold text-gray-400 uppercase mb-1\">Ouvrages publi√©s</label>\n                                    <textarea name=\"published_works\" value={formData.published_works} onChange={handleInputChange} className=\"w-full bg-gray-50 border border-gray-200 rounded-lg py-2 px-3 text-sm focus:border-note-purple outline-none\" rows={2} />\n                                </div>\n                            )}\n                            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                                <div>\n                                    <label className=\"block text-xs font-bold text-gray-400 uppercase mb-1\">Genres</label>\n                                    <input name=\"literary_genres\" value={formData.literary_genres} onChange={handleInputChange} className=\"w-full bg-gray-50 border border-gray-200 rounded-lg py-2 px-3 text-sm focus:border-note-purple outline-none\" />\n                                </div>\n                                <div>\n                                    <label className=\"block text-xs font-bold text-gray-400 uppercase mb-1\">Langues d'√©criture</label>\n                                    <input name=\"writing_languages\" value={formData.writing_languages} onChange={handleInputChange} className=\"w-full bg-gray-50 border border-gray-200 rounded-lg py-2 px-3 text-sm focus:border-note-purple outline-none\" />\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n\n                    {/* Section: Pr√©sence en Ligne */}\n                    <div className=\"pt-6 border-t border-gray-100\">\n                        <h3 className=\"text-lg font-bold text-gray-800 mb-4 flex items-center gap-2\">\n                            <Globe className=\"w-5 h-5 text-indigo-500\" />\n                            Pr√©sence en Ligne\n                        </h3>\n                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                            <div>\n                                <label className=\"block text-xs font-bold text-gray-400 uppercase mb-1\">Facebook</label>\n                                <input name=\"social_facebook\" value={formData.social_facebook} onChange={handleInputChange} className=\"w-full bg-gray-50 border border-gray-200 rounded-lg py-2 px-3 text-sm focus:border-note-purple outline-none\" />\n                            </div>\n                            <div>\n                                <label className=\"block text-xs font-bold text-gray-400 uppercase mb-1\">Instagram</label>\n                                <input name=\"social_instagram\" value={formData.social_instagram} onChange={handleInputChange} className=\"w-full bg-gray-50 border border-gray-200 rounded-lg py-2 px-3 text-sm focus:border-note-purple outline-none\" />\n                            </div>\n                            <div>\n                                <label className=\"block text-xs font-bold text-gray-400 uppercase mb-1\">Site Web</label>\n                                <input name=\"website\" value={formData.website} onChange={handleInputChange} className=\"w-full bg-gray-50 border border-gray-200 rounded-lg py-2 px-3 text-sm focus:border-note-purple outline-none\" />\n                            </div>\n                        </div>\n                    </div>\n\n                    <hr className=\"border-gray-100 my-6\" />\n\n                    {/* Security Zone */}\n                    <div className=\"pt-6 border-t border-gray-100\">\n                        <h3 className=\"text-lg font-bold text-gray-800 mb-4 flex items-center gap-2\">\n                            <Shield className=\"w-5 h-5 text-gray-400\" />\n                            S√©curit√© & Syst√®me\n                        </h3>\n\n                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6\">\n                            <div className=\"bg-gray-50 p-4 rounded-xl border border-gray-100\">\n                                <span className=\"text-xs text-gray-400 uppercase font-bold block mb-1\">Derni√®re mise √† jour</span>\n                                <span className=\"text-sm text-gray-700\">{profile.updated_at ? new Date(profile.updated_at).toLocaleString() : 'Jamais'}</span>\n                            </div>\n                            <div className=\"bg-gray-50 p-4 rounded-xl border border-gray-100\">\n                                <span className=\"text-xs text-gray-400 uppercase font-bold block mb-1\">ID Supabase</span>\n                                <span className=\"text-xs text-gray-500 font-mono break-all\">{profile.id}</span>\n                            </div>\n                        </div>\n\n                        <div className=\"bg-yellow-50 border border-yellow-100 rounded-lg p-4 flex flex-col md:flex-row items-center justify-between gap-4\">\n                            <div>\n                                <h4 className=\"font-bold text-yellow-800 text-sm\">R√©initialisation du mot de passe</h4>\n                                <p className=\"text-yellow-700 text-xs mt-1\">\n                                    Envoie un email s√©curis√© √† l'utilisateur pour qu'il change son mot de passe.\n                                </p>\n                            </div>\n                            <button\n                                onClick={handlePasswordReset}\n                                className=\"whitespace-nowrap px-4 py-2 bg-white border border-yellow-200 text-yellow-700 hover:bg-yellow-100 rounded-lg text-sm font-medium transition-colors flex items-center gap-2\"\n                            >\n                                <Mail className=\"w-4 h-4\" />\n                                Envoyer l'email\n                            </button>\n                        </div>\n                    </div>\n                </div>\n\n                {/* Footer Actions */}\n                <div className=\"bg-gray-50 p-6 border-t border-gray-200 flex justify-end gap-3\">\n                    <button\n                        onClick={() => navigate('/admin/users')}\n                        className=\"px-6 py-2 border border-gray-200 text-gray-600 rounded-lg font-bold hover:bg-white transition-colors\"\n                    >\n                        Annuler\n                    </button>\n                    <button\n                        onClick={handleSave}\n                        disabled={updating}\n                        className=\"px-6 py-2 bg-note-purple text-white rounded-lg font-bold hover:bg-violet-700 shadow-md flex items-center gap-2 disabled:opacity-70 disabled:cursor-not-allowed transform active:scale-95 transition-all\"\n                    >\n                        <Save className=\"w-4 h-4\" />\n                        {updating ? 'Enregistrement...' : 'Enregistrer'}\n                    </button>\n                </div>\n            </div>\n        </div>\n    );\n};\n\nexport default UserDetails;\n","usedDeprecatedRules":[]},{"filePath":"/Users/mac/Desktop/akouass/note/site de publising/site 1 /src/pages/admin/UsersManager.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'currentUser' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":8,"column":19,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":30,"suggestions":[{"messageId":"removeVar","data":{"varName":"currentUser"},"fix":{"range":[308,348],"text":""},"desc":"Remove unused variable 'currentUser'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'handleUpdateRole' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":44,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":44,"endColumn":27,"suggestions":[{"messageId":"removeVar","data":{"varName":"handleUpdateRole"},"fix":{"range":[1370,2044],"text":""},"desc":"Remove unused variable 'handleUpdateRole'."}]},{"ruleId":"no-undef","severity":2,"message":"'roleSelect' is not defined.","line":50,"column":33,"nodeType":"Identifier","messageId":"undef","endLine":50,"endColumn":43},{"ruleId":"no-undef","severity":2,"message":"'roleSelect' is not defined.","line":56,"column":77,"nodeType":"Identifier","messageId":"undef","endLine":56,"endColumn":87}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { supabase } from '../../supabaseClient';\nimport { useAuth } from '../../contexts/AuthContext';\nimport { MoreVertical, Shield, User, Edit, Trash2, Eye } from 'lucide-react';\n\nconst UsersManager = () => {\n    const { user: currentUser } = useAuth();\n    const navigate = useNavigate();\n    const [users, setUsers] = useState([]);\n    const [loading, setLoading] = useState(true);\n    const [error, setError] = useState(null);\n\n    // Editing State (Deprecated in favor of detail page)\n    const [editingUser, setEditingUser] = useState(null);\n\n    useEffect(() => {\n        fetchUsers();\n    }, []);\n\n    const fetchUsers = async () => {\n        setLoading(true);\n        try {\n            // Note: 'profiles' table should be readable by admin\n            const { data, error } = await supabase\n                .from('profiles')\n                .select('*')\n                .order('created_at', { ascending: false });\n\n            if (error) throw error;\n            setUsers(data || []);\n        } catch (err) {\n            console.error(\"Error fetching users:\", err);\n            setError(err.message);\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const handleEditClick = (user) => {\n        navigate(`/admin/users/${user.id}`);\n    };\n\n    const handleUpdateRole = async () => {\n        if (!editingUser) return;\n\n        try {\n            const { error } = await supabase\n                .from('profiles')\n                .update({ role: roleSelect })\n                .eq('id', editingUser.id);\n\n            if (error) throw error;\n\n            // Optimistic update\n            setUsers(users.map(u => u.id === editingUser.id ? { ...u, role: roleSelect } : u));\n            setEditingUser(null);\n            alert(\"R√¥le mis √† jour avec succ√®s !\");\n        } catch (err) {\n            console.error(\"Error updating role:\", err);\n            alert(\"Erreur lors de la mise √† jour : \" + err.message);\n        }\n    };\n\n    if (loading) return <div className=\"p-8 text-center text-gray-500\">Chargement des utilisateurs...</div>;\n\n    return (\n        <div className=\"space-y-6\">\n            <div className=\"flex justify-between items-center\">\n                <div className=\"flex items-center gap-4\">\n                    <h1 className=\"text-2xl font-bold text-gray-800\">Gestion des Utilisateurs</h1>\n                    <span className=\"bg-gray-100 text-gray-600 px-3 py-1 rounded-full text-xs font-medium\">\n                        Total: {users.length}\n                    </span>\n                </div>\n                <button\n                    onClick={() => navigate('/admin/users/new')}\n                    className=\"bg-note-purple hover:bg-violet-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-2\"\n                >\n                    <span>+</span> Ajouter\n                </button>\n            </div>\n\n            {error && (\n                <div className=\"bg-red-50 text-red-600 p-4 rounded-lg border border-red-100\">\n                    {error}\n                </div>\n            )}\n\n            <div className=\"bg-white rounded-xl border border-gray-200 overflow-hidden shadow-sm\">\n                <table className=\"w-full text-left text-sm text-gray-600\">\n                    <thead className=\"bg-gray-50 border-b border-gray-200 text-xs uppercase font-medium text-gray-500\">\n                        <tr>\n                            <th className=\"px-6 py-4\">Utilisateur</th>\n                            <th className=\"px-6 py-4\">Role</th>\n                            <th className=\"px-6 py-4\">Nom Complet</th>\n                            <th className=\"px-6 py-4 text-right\">Actions</th>\n                        </tr>\n                    </thead>\n                    <tbody className=\"divide-y divide-gray-100\">\n                        {users.length === 0 ? (\n                            <tr>\n                                <td colSpan=\"4\" className=\"px-6 py-12 text-center text-gray-400\">\n                                    Aucun utilisateur trouv√©.\n                                </td>\n                            </tr>\n                        ) : (\n                            users.map((u) => (\n                                <tr key={u.id} className=\"hover:bg-gray-50/50 transition-colors\">\n                                    <td className=\"px-6 py-4\">\n                                        <div className=\"flex items-center gap-3\">\n                                            <div className=\"w-8 h-8 rounded-full bg-violet-100 flex items-center justify-center text-note-purple font-bold text-xs\">\n                                                {(u.full_name || u.email || '?').charAt(0).toUpperCase()}\n                                            </div>\n                                            <div className=\"font-medium text-gray-900\">{u.email || 'N/A'}</div>\n                                        </div>\n                                    </td>\n                                    <td className=\"px-6 py-4\">\n                                        <span className={`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium border ${u.role === 'admin'\n                                            ? 'bg-purple-50 text-purple-700 border-purple-100'\n                                            : 'bg-gray-50 text-gray-600 border-gray-200'\n                                            }`}>\n                                            {u.role === 'admin' ? <Shield className=\"w-3 h-3\" /> : <User className=\"w-3 h-3\" />}\n                                            {u.role || 'author'}\n                                        </span>\n                                    </td>\n                                    <td className=\"px-6 py-4 text-gray-500\">\n                                        {u.full_name || '-'}\n                                    </td>\n                                    <td className=\"px-6 py-4 text-right\">\n                                        <div className=\"flex justify-end gap-2\">\n                                            <button\n                                                onClick={() => handleEditClick(u)}\n                                                className=\"text-gray-400 hover:text-note-purple p-2 rounded-lg hover:bg-gray-100 transition-all\"\n                                                title=\"Afficher les d√©tails\"\n                                            >\n                                                <Eye className=\"w-4 h-4\" />\n                                            </button>\n                                            <button\n                                                onClick={() => handleEditClick(u)}\n                                                className=\"text-gray-400 hover:text-note-purple p-2 rounded-lg hover:bg-gray-100 transition-all\"\n                                                title=\"Modifier le r√¥le\"\n                                            >\n                                                <Edit className=\"w-4 h-4\" />\n                                            </button>\n                                        </div>\n                                    </td>\n                                </tr>\n                            ))\n                        )}\n                    </tbody>\n                </table>\n            </div>\n\n            {/* Edit Modal (Deprecated) */}\n            {editingUser && (\n                <div className=\"fixed inset-0 bg-black/50 z-50 flex items-center justify-center backdrop-blur-sm p-4\">\n                    {/* Placeholder if we ever need modal back, but now redirected */}\n                </div>\n            )}\n        </div>\n    );\n};\n\nexport default UsersManager;\n","usedDeprecatedRules":[]},{"filePath":"/Users/mac/Desktop/akouass/note/site de publising/site 1 /src/pages/auth/Login.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/mac/Desktop/akouass/note/site de publising/site 1 /src/pages/author/AuthorContentManager.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/mac/Desktop/akouass/note/site de publising/site 1 /src/pages/author/AuthorDashboard.jsx","messages":[{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: Cannot access variable before it is declared\n\n`fetchStats` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\n  13 |\n  14 |     useEffect(() => {\n> 15 |         if (user) fetchStats();\n     |                   ^^^^^^^^^^ `fetchStats` accessed before it is declared\n  16 |     }, [user]);\n  17 |\n  18 |     const fetchStats = async () => {\n\n  16 |     }, [user]);\n  17 |\n> 18 |     const fetchStats = async () => {\n     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 19 |         try {\n     | ^^^^^^^^^^^^^\n> 20 |             // Count total\n     ‚Ä¶\n     | ^^^^^^^^^^^^^\n> 58 |         }\n     | ^^^^^^^^^^^^^\n> 59 |     };\n     | ^^^^^^^ `fetchStats` is declared here\n  60 |\n  61 |     return (\n  62 |         <div className=\"space-y-8\">","line":15,"column":19,"nodeType":null,"endLine":15,"endColumn":29},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchStats'. Either include it or remove the dependency array.","line":16,"column":8,"nodeType":"ArrayExpression","endLine":16,"endColumn":14,"suggestions":[{"desc":"Update the dependencies array to be: [fetchStats, user]","fix":{"range":[650,656],"text":"[fetchStats, user]"}}]},{"ruleId":"no-unused-vars","severity":2,"message":"'err1' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":21,"column":42,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":46,"suggestions":[{"messageId":"removeVar","data":{"varName":"err1"},"fix":{"range":[770,783],"text":""},"desc":"Remove unused variable 'err1'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'err2' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":27,"column":44,"nodeType":"Identifier","messageId":"unusedVar","endLine":27,"endColumn":48,"suggestions":[{"messageId":"removeVar","data":{"varName":"err2"},"fix":{"range":[1020,1033],"text":""},"desc":"Remove unused variable 'err2'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'err3' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":34,"column":46,"nodeType":"Identifier","messageId":"unusedVar","endLine":34,"endColumn":50,"suggestions":[{"messageId":"removeVar","data":{"varName":"err3"},"fix":{"range":[1307,1320],"text":""},"desc":"Remove unused variable 'err3'."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\nimport { useAuth } from '../../contexts/AuthContext';\nimport { supabase } from '../../supabaseClient';\nimport { useNavigate } from 'react-router-dom';\nimport { BookOpen, Clock, CheckCircle, Plus } from 'lucide-react';\nimport ProfileCompletionCard from '../../components/ProfileCompletionCard';\n\nconst AuthorDashboard = () => {\n    const { user } = useAuth();\n    const navigate = useNavigate();\n    const [stats, setStats] = useState({ total: 0, pending: 0, validated: 0 });\n    const [recentManuscripts, setRecentManuscripts] = useState([]);\n\n    useEffect(() => {\n        if (user) fetchStats();\n    }, [user]);\n\n    const fetchStats = async () => {\n        try {\n            // Count total\n            const { count: total, error: err1 } = await supabase\n                .from('publications')\n                .select('*', { count: 'exact', head: true })\n                .eq('user_id', user.id);\n\n            // Count pending (en attente)\n            const { count: pending, error: err2 } = await supabase\n                .from('publications')\n                .select('*', { count: 'exact', head: true })\n                .eq('user_id', user.id)\n                .eq('position', 'en attente');\n\n            // Count validated\n            const { count: validated, error: err3 } = await supabase\n                .from('publications')\n                .select('*', { count: 'exact', head: true })\n                .eq('user_id', user.id)\n                .eq('position', 'valid√©');\n\n            setStats({\n                total: total || 0,\n                pending: pending || 0,\n                validated: validated || 0\n            });\n\n            // Fetch recent\n            const { data } = await supabase\n                .from('publications')\n                .select('*')\n                .eq('user_id', user.id)\n                .order('created_at', { ascending: false })\n                .limit(5);\n\n            setRecentManuscripts(data || []);\n\n        } catch (error) {\n            console.error(\"Error fetching dashboard stats:\", error);\n        }\n    };\n\n    return (\n        <div className=\"space-y-8\">\n            <div className=\"flex justify-between items-center\">\n                <div>\n                    <h1 className=\"text-2xl font-bold text-gray-800\">Bienvenue, {user?.full_name?.split(' ')[0]}</h1>\n                    <p className=\"text-gray-500\">G√©rez vos publications et suivez leur statut.</p>\n                </div>\n                <button\n                    onClick={() => navigate('/author/content/new')}\n                    className=\"bg-note-purple hover:bg-violet-700 text-white px-4 py-2 rounded-lg text-sm font-medium flex items-center gap-2 shadow-sm\"\n                >\n                    <Plus className=\"w-4 h-4\" /> Nouveau Manuscrit\n                </button>\n            </div>\n\n            {/* Profile Completion Card */}\n            <ProfileCompletionCard />\n\n            {/* Stats Cards */}\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n                <div className=\"bg-white p-6 rounded-2xl border border-gray-100 shadow-sm flex items-center gap-4\">\n                    <div className=\"p-3 bg-blue-50 text-blue-600 rounded-xl\">\n                        <BookOpen className=\"w-6 h-6\" />\n                    </div>\n                    <div>\n                        <p className=\"text-sm text-gray-400 font-medium\">Total Publications</p>\n                        <p className=\"text-2xl font-bold text-gray-800\">{stats.total}</p>\n                    </div>\n                </div>\n                <div className=\"bg-white p-6 rounded-2xl border border-gray-100 shadow-sm flex items-center gap-4\">\n                    <div className=\"p-3 bg-amber-50 text-amber-600 rounded-xl\">\n                        <Clock className=\"w-6 h-6\" />\n                    </div>\n                    <div>\n                        <p className=\"text-sm text-gray-400 font-medium\">En Attente</p>\n                        <p className=\"text-2xl font-bold text-gray-800\">{stats.pending}</p>\n                    </div>\n                </div>\n                <div className=\"bg-white p-6 rounded-2xl border border-gray-100 shadow-sm flex items-center gap-4\">\n                    <div className=\"p-3 bg-green-50 text-green-600 rounded-xl\">\n                        <CheckCircle className=\"w-6 h-6\" />\n                    </div>\n                    <div>\n                        <p className=\"text-sm text-gray-400 font-medium\">Valid√©s</p>\n                        <p className=\"text-2xl font-bold text-gray-800\">{stats.validated}</p>\n                    </div>\n                </div>\n            </div>\n\n            {/* Recent Table */}\n            <div className=\"bg-white rounded-xl border border-gray-200 overflow-hidden shadow-sm\">\n                <div className=\"p-6 border-b border-gray-100\">\n                    <h2 className=\"font-bold text-gray-800\">Vos manuscrits r√©cents</h2>\n                </div>\n                <table className=\"w-full text-left text-sm text-gray-600\">\n                    <thead className=\"bg-gray-50 border-b border-gray-200 text-xs uppercase font-medium text-gray-500\">\n                        <tr>\n                            <th className=\"px-6 py-4\">Titre</th>\n                            <th className=\"px-6 py-4\">Date</th>\n                            <th className=\"px-6 py-4\">Statut</th>\n                            <th className=\"px-6 py-4 text-right\">Actions</th>\n                        </tr>\n                    </thead>\n                    <tbody className=\"divide-y divide-gray-100\">\n                        {recentManuscripts.length === 0 ? (\n                            <tr><td colSpan=\"4\" className=\"text-center py-8 text-gray-400\">Aucun manuscrit trouv√©.</td></tr>\n                        ) : (\n                            recentManuscripts.map(m => (\n                                <tr key={m.id} className=\"hover:bg-gray-50/50\">\n                                    <td className=\"px-6 py-4 font-medium text-gray-900\">{m.title_main}</td>\n                                    <td className=\"px-6 py-4\">{new Date(m.created_at).toLocaleDateString()}</td>\n                                    <td className=\"px-6 py-4\">\n                                        <span className={`px-2 py-1 rounded-full text-xs border ${m.position === 'valid√©' ? 'bg-green-50 text-green-700 border-green-100' :\n                                            m.position === 'en attente' ? 'bg-amber-50 text-amber-700 border-amber-100' :\n                                                'bg-gray-50 text-gray-600 border-gray-200'\n                                            }`}>\n                                            {m.position}\n                                        </span>\n                                    </td>\n                                    <td className=\"px-6 py-4 text-right\">\n                                        <button onClick={() => navigate(`/author/content/${m.id}`)} className=\"text-note-purple hover:underline\">Modifier</button>\n                                    </td>\n                                </tr>\n                            ))\n                        )}\n                    </tbody>\n                </table>\n            </div>\n        </div>\n    );\n};\n\nexport default AuthorDashboard;\n","usedDeprecatedRules":[]},{"filePath":"/Users/mac/Desktop/akouass/note/site de publising/site 1 /src/pages/common/ProfilePage.jsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadProfile'. Either include it or remove the dependency array.","line":72,"column":8,"nodeType":"ArrayExpression","endLine":72,"endColumn":14,"suggestions":[{"desc":"Update the dependencies array to be: [loadProfile, user]","fix":{"range":[2230,2236],"text":"[loadProfile, user]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\nimport { useAuth } from '../../contexts/AuthContext';\nimport { supabase } from '../../supabaseClient';\nimport { Save, Upload, User, Briefcase, GraduationCap, Book, Globe, Key, Mail } from 'lucide-react';\n\nconst ProfilePage = () => {\n    const authContext = useAuth();\n    console.log(\"ProfilePage: Auth Context values:\", Object.keys(authContext));\n    const { user, fetchProfile } = authContext;\n    const [loading, setLoading] = useState(true);\n    const [saving, setSaving] = useState(false);\n    const [idFile, setIdFile] = useState(null);\n    const [avatarFile, setAvatarFile] = useState(null);\n\n    // Enhanced Literary Section State\n    const [genres, setGenres] = useState([]);\n    const [languages, setLanguages] = useState([]);\n    const [books, setBooks] = useState([]);\n\n    // Inputs for adding new items\n    const [newBook, setNewBook] = useState({ title: '', publisher: '', year: '' });\n    const [genreInput, setGenreInput] = useState('');\n    const [langInput, setLangInput] = useState('');\n\n    const [passwordData, setPasswordData] = useState({\n        newPassword: '',\n        confirmPassword: ''\n    });\n\n    const [formData, setFormData] = useState({\n        full_name: '',\n        birth_date: '',\n        birth_place: '',\n        nationality: '',\n        id_card_number: '',\n        id_card_type: 'CNI',\n        id_card_url: '',\n        avatar_url: '',\n        bio: '',\n        address: '',\n        phone: '',\n        // Professional\n        profession: '',\n        professional_status: '',\n        employer: '',\n        activity_field: '',\n        experience_years: '',\n        // Academic\n        last_degree: '',\n        specialty: '',\n        university: '',\n        degree_year: '',\n        high_school_level: '',\n        high_school_name: '',\n        bac_year: '',\n        // Literary\n        has_published: false,\n        published_works: '',\n        literary_genres: '',\n        writing_languages: '',\n        // Social\n        social_facebook: '',\n        social_instagram: '',\n        social_twitter: '',\n        social_linkedin: '',\n        social_youtube: '',\n        website: ''\n    });\n\n    useEffect(() => {\n        if (user) loadProfile();\n    }, [user]);\n\n    const loadProfile = async () => {\n        try {\n            const { data, error } = await supabase\n                .from('profiles')\n                .select('*')\n                .eq('id', user.id)\n                .single();\n\n            if (error) throw error;\n            if (data) {\n                // Merge data and ensure no null values\n                const cleanData = Object.keys(data).reduce((acc, key) => {\n                    let val = data[key];\n                    // Handle array fields: Convert to comma-separated string for the UI\n                    if (Array.isArray(val)) {\n                        // Keep arrays for our internal state management, but form might expect strings? \n                        // Actually we will sync our local 'genres'/'languages' state with these arrays\n                        // and let formData hold the formatted string version for compatibility if needed, \n                        // or just rely on our local state and ignore formData for these specific fields.\n                    }\n\n                    // Provide defaults for specific fields if they are null in DB\n                    if (key === 'id_card_type' && !val) val = 'CNI';\n\n                    acc[key] = val ?? '';\n                    return acc;\n                }, {});\n\n                setFormData(prev => ({\n                    ...prev,\n                    ...cleanData,\n                    has_published: data.has_published === true\n                }));\n\n                // Initialize Enhanced Literary State\n                // Genres & Languages (Handle both Array and String formats from DB)\n                const parseTags = (val) => {\n                    if (Array.isArray(val)) return val;\n                    if (typeof val === 'string' && val.trim()) return val.split(',').map(s => s.trim());\n                    return [];\n                };\n                setGenres(parseTags(data.literary_genres));\n                setLanguages(parseTags(data.writing_languages));\n\n                // Books (Parse from string: \"Title (Year) - Publisher \\n ...\")\n                if (data.published_works) {\n                    // Simple parser assuming \"Title (Year) - Publisher\" format we will enforce\n                    // Or just split by newline for now if it was a textarea\n                    const rawBooks = data.published_works.split('\\n').filter(b => b.trim());\n                    const parsedBooks = rawBooks.map(b => {\n                        // Try to match \"Title (Year) - Publisher\"\n                        const match = b.match(/^(.*) \\((\\d{4})\\) - (.*)$/);\n                        if (match) {\n                            return { title: match[1], year: match[2], publisher: match[3], original: b };\n                        }\n                        return { title: b, year: '', publisher: '', original: b };\n                    });\n                    setBooks(parsedBooks);\n                }\n            }\n        } catch (err) {\n            console.error(\"Error loading profile:\", err);\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const handleChange = (e) => {\n        const { name, value, type, checked } = e.target;\n        setFormData(prev => ({\n            ...prev,\n            [name]: type === 'checkbox' ? checked : value\n        }));\n    };\n\n    const handlePasswordChange = (e) => {\n        const { name, value } = e.target;\n        setPasswordData(prev => ({ ...prev, [name]: value }));\n    };\n\n    const handleChangePassword = async () => {\n        if (passwordData.newPassword !== passwordData.confirmPassword) {\n            alert(\"Les mots de passe ne correspondent pas !\");\n            return;\n        }\n\n        if (passwordData.newPassword.length < 6) {\n            alert(\"Le mot de passe doit contenir au moins 6 caract√®res !\");\n            return;\n        }\n\n        try {\n            const { error } = await supabase.auth.updateUser({\n                password: passwordData.newPassword\n            });\n\n            if (error) throw error;\n\n            alert(\"Mot de passe modifi√© avec succ√®s !\");\n            setPasswordData({ newPassword: '', confirmPassword: '' });\n        } catch (err) {\n            console.error(\"Error updating password:\", err);\n            alert(\"Erreur : \" + err.message);\n        }\n    };\n\n    const handleFileChange = (e) => {\n        if (e.target.files && e.target.files[0]) {\n            setIdFile(e.target.files[0]);\n        }\n    };\n\n    const handleAvatarChange = (e) => {\n        if (e.target.files && e.target.files[0]) {\n            const file = e.target.files[0];\n            setAvatarFile(file);\n            // Preview\n            const reader = new FileReader();\n            reader.onloadend = () => {\n                setFormData(prev => ({ ...prev, avatar_url: reader.result }));\n            };\n            reader.readAsDataURL(file);\n        }\n    };\n\n    const uploadIdentityDoc = async () => {\n        if (!idFile) return formData.id_card_url;\n\n        const fileExt = idFile.name.split('.').pop();\n        const fileName = `id_${Date.now()}.${fileExt}`;\n        const filePath = `${user.id}/${fileName}`;\n\n        const { error } = await supabase.storage\n            .from('identity_documents')\n            .upload(filePath, idFile, { upsert: true });\n\n        if (error) throw error;\n        return filePath;\n    };\n\n    const uploadAvatar = async () => {\n        if (!avatarFile) return null; // If no new file, return null to signal no change or keep existing\n\n        const fileExt = avatarFile.name.split('.').pop();\n        const fileName = `avatar_${Date.now()}.${fileExt}`;\n        const filePath = `${user.id}/${fileName}`;\n\n        const { error } = await supabase.storage\n            .from('avatars')\n            .upload(filePath, avatarFile, { upsert: true });\n\n        if (error) {\n            console.error(\"Avatar upload error:\", error);\n            if (error.message.includes(\"Bucket not found\") || error.statusCode === '404') {\n                alert(\"Erreur: Le dossier de stockage 'avatars' n'existe pas. Veuillez contacter l'administrateur pour le cr√©er sur Supabase.\");\n                return null;\n            }\n            throw error;\n        }\n\n        // Get public URL\n        const { data } = supabase.storage.from('avatars').getPublicUrl(filePath);\n        return data.publicUrl;\n    };\n\n    const handleSubmit = async (e) => {\n        e.preventDefault();\n        setSaving(true);\n\n        try {\n            const idDocPath = await uploadIdentityDoc();\n            const newAvatarUrl = await uploadAvatar();\n\n            // Prepare updates: Convert specific strings back to arrays for Supabase\n            const updates = { ...formData };\n\n            // If we uploaded a new avatar, use the new URL\n            if (newAvatarUrl) {\n                updates.avatar_url = newAvatarUrl;\n            }\n\n            // 1. Explicit Array Fields (Synced from local state)\n            // We ignore whatever string might be in formData and use our structured state\n            updates.literary_genres = genres.length > 0 ? genres : null;\n            updates.writing_languages = languages.length > 0 ? languages : null;\n\n            // 2. Published Works (Concatenate books into string)\n            if (books.length > 0) {\n                updates.published_works = books.map(b => {\n                    if (b.title && b.year && b.publisher) return `${b.title} (${b.year}) - ${b.publisher}`;\n                    return b.original || b.title;\n                }).join('\\n');\n            } else {\n                updates.published_works = null;\n            }\n\n            // 3. Dynamic Safety: Convert ANY remaining empty strings to NULL\n            // Postgres array columns reject \"\" but accept NULL. \n            // Standard text columns also handle NULL fine.\n            const sanitizedData = Object.keys(updates).reduce((acc, key) => {\n                const val = updates[key];\n                // Exception: id_card_type should stay 'CNI' or 'Passeport', never null/empty if possible\n                if (key === 'id_card_type' && !val) {\n                    acc[key] = 'CNI';\n                } else {\n                    acc[key] = (val === '') ? null : val;\n                }\n                return acc;\n            }, {});\n\n            const finalData = {\n                ...sanitizedData,\n                id_card_url: idDocPath,\n                updated_at: new Date()\n            };\n\n            console.log(\"ProfilePage: Sending sanitized data:\", finalData);\n\n            const { error } = await supabase\n                .from('profiles')\n                .update(finalData)\n                .eq('id', user.id);\n\n            if (error) throw error;\n\n            alert(\"Profil mis √† jour avec succ√®s !\");\n            // Refresh context profile if needed (mostly for name changes)\n            if (typeof fetchProfile === 'function') {\n                await fetchProfile(user);\n            } else {\n                console.warn(\"ProfilePage: fetchProfile is not available in context yet.\");\n                // Fallback: reload the local state at least\n                await loadProfile();\n            }\n\n        } catch (err) {\n            console.error(\"Error updating profile:\", err);\n            alert(\"Erreur : \" + err.message);\n        } finally {\n            setSaving(false);\n        }\n    };\n\n    if (loading) return <div className=\"p-8 text-center\">Chargement...</div>;\n\n    return (\n        <div className=\"max-w-5xl mx-auto pb-20\">\n            <h1 className=\"text-3xl font-bold text-gray-800 mb-2\">Mon Profil</h1>\n            <p className=\"text-gray-500 mb-8\">Compl√©tez vos informations pour finaliser votre dossier auteur.</p>\n\n            <form onSubmit={handleSubmit} className=\"space-y-8\">\n\n                {/* 0. PARAM√àTRES DU COMPTE */}\n                <section className=\"bg-white p-6 rounded-2xl border border-gray-100 shadow-sm\">\n                    <div className=\"flex items-center gap-3 mb-6 border-b pb-4\">\n                        <div className=\"p-2 bg-green-50 text-green-600 rounded-lg\"><Key className=\"w-5 h-5\" /></div>\n                        <h2 className=\"text-xl font-bold text-gray-800\">Param√®tres du Compte</h2>\n                    </div>\n\n                    <div className=\"space-y-6\">\n                        {/* Avatar & Bio Section */}\n                        <div className=\"flex flex-col items-center justify-center p-6 bg-gray-50 rounded-xl border border-dashed border-gray-300\">\n                            <div className=\"relative group cursor-pointer\" onClick={() => document.getElementById('avatar-upload').click()}>\n                                <div className=\"w-32 h-32 rounded-full overflow-hidden border-4 border-white shadow-lg bg-gray-200 flex items-center justify-center\">\n                                    {formData.avatar_url ? (\n                                        <img src={formData.avatar_url} alt=\"Profile\" className=\"w-full h-full object-cover\" />\n                                    ) : (\n                                        <User className=\"w-12 h-12 text-gray-400\" />\n                                    )}\n                                </div>\n                                <div className=\"absolute inset-0 bg-black/40 rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity\">\n                                    <Upload className=\"w-8 h-8 text-white\" />\n                                </div>\n                                <input\n                                    type=\"file\"\n                                    id=\"avatar-upload\"\n                                    accept=\"image/*\"\n                                    onChange={handleAvatarChange}\n                                    className=\"hidden\"\n                                />\n                            </div>\n                            <p className=\"text-xs text-gray-500 mt-3\">Cliquez pour modifier votre photo</p>\n                        </div>\n\n                        {/* Bio */}\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 mb-1\">Biographie</label>\n                            <textarea\n                                name=\"bio\"\n                                value={formData.bio || ''}\n                                onChange={handleChange}\n                                rows={4}\n                                placeholder=\"Parlez-nous un peu de vous...\"\n                                className=\"w-full border border-gray-300 rounded-lg px-3 py-2\"\n                            />\n                            <p className=\"text-xs text-gray-500 mt-1\">Une courte description qui appara√Ætra sur votre profil public.</p>\n                        </div>\n\n                        {/* Email (Read-only, display current) */}\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 mb-1\">Email de connexion</label>\n                            <div className=\"flex items-center gap-3\">\n                                <Mail className=\"w-5 h-5 text-gray-400\" />\n                                <input\n                                    type=\"email\"\n                                    value={user?.email || ''}\n                                    disabled\n                                    className=\"flex-1 border border-gray-300 rounded-lg px-3 py-2 bg-gray-50 text-gray-600 cursor-not-allowed\"\n                                />\n                                <span className=\"text-xs text-gray-500\">Non modifiable</span>\n                            </div>\n                        </div>\n\n                        {/* Password Change */}\n                        <div className=\"border-t pt-4\">\n                            <h3 className=\"font-bold text-gray-800 mb-4\">Changer le mot de passe</h3>\n                            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">Nouveau mot de passe</label>\n                                    <input\n                                        type=\"password\"\n                                        name=\"newPassword\"\n                                        value={passwordData.newPassword}\n                                        onChange={handlePasswordChange}\n                                        placeholder=\"Au moins 6 caract√®res\"\n                                        className=\"w-full border border-gray-300 rounded-lg px-3 py-2\"\n                                    />\n                                </div>\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">Confirmer le mot de passe</label>\n                                    <input\n                                        type=\"password\"\n                                        name=\"confirmPassword\"\n                                        value={passwordData.confirmPassword}\n                                        onChange={handlePasswordChange}\n                                        placeholder=\"Retapez le mot de passe\"\n                                        className=\"w-full border border-gray-300 rounded-lg px-3 py-2\"\n                                    />\n                                </div>\n                            </div>\n                            <button\n                                type=\"button\"\n                                onClick={handleChangePassword}\n                                disabled={!passwordData.newPassword || !passwordData.confirmPassword}\n                                className=\"mt-4 bg-green-600 hover:bg-green-700 disabled:bg-gray-300 text-white px-6 py-2 rounded-lg font-medium transition-colors\"\n                            >\n                                Mettre √† jour le mot de passe\n                            </button>\n                        </div>\n                    </div>\n                </section>\n\n                {/* 1. INFORMATIONS PERSONNELLES */}\n                <section className=\"bg-white p-6 rounded-2xl border border-gray-100 shadow-sm\">\n                    <div className=\"flex items-center gap-3 mb-6 border-b pb-4\">\n                        <div className=\"p-2 bg-blue-50 text-blue-600 rounded-lg\"><User className=\"w-5 h-5\" /></div>\n                        <h2 className=\"text-xl font-bold text-gray-800\">Informations Personnelles</h2>\n                    </div>\n\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 mb-1\">Nom complet</label>\n                            <input\n                                name=\"full_name\"\n                                value={formData.full_name}\n                                onChange={handleChange}\n                                className=\"w-full border border-gray-300 rounded-lg px-3 py-2\"\n                                required\n                            />\n                        </div>\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 mb-1\">Nationalit√©</label>\n                            <input\n                                name=\"nationality\"\n                                value={formData.nationality}\n                                onChange={handleChange}\n                                className=\"w-full border border-gray-300 rounded-lg px-3 py-2\"\n                            />\n                        </div>\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 mb-1\">Date de naissance</label>\n                            <input\n                                type=\"date\"\n                                name=\"birth_date\"\n                                value={formData.birth_date || ''}\n                                onChange={handleChange}\n                                className=\"w-full border border-gray-300 rounded-lg px-3 py-2\"\n                            />\n                        </div>\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 mb-1\">Lieu de naissance</label>\n                            <input\n                                name=\"birth_place\"\n                                value={formData.birth_place || ''}\n                                onChange={handleChange}\n                                className=\"w-full border border-gray-300 rounded-lg px-3 py-2\"\n                            />\n                        </div>\n\n                        {/* ID */}\n                        <div className=\"col-span-1 md:col-span-2 grid grid-cols-1 md:grid-cols-3 gap-4 mt-2 bg-gray-50 p-4 rounded-xl\">\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 mb-1\">Type de pi√®ce</label>\n                                <div className=\"space-y-2\">\n                                    <select\n                                        name=\"id_card_type_select\"\n                                        value={['CNI', 'Permis de conduire', 'Passeport'].includes(formData.id_card_type) ? formData.id_card_type : 'Autre'}\n                                        onChange={(e) => {\n                                            const val = e.target.value;\n                                            if (val !== 'Autre') {\n                                                setFormData(prev => ({ ...prev, id_card_type: val }));\n                                            } else {\n                                                // If switching to 'Autre', clear the value to let user type, unless it was already a custom value\n                                                if (['CNI', 'Permis de conduire', 'Passeport'].includes(formData.id_card_type)) {\n                                                    setFormData(prev => ({ ...prev, id_card_type: '' }));\n                                                }\n                                            }\n                                        }}\n                                        className=\"w-full border border-gray-300 rounded-lg px-3 py-2\"\n                                    >\n                                        <option value=\"CNI\">Carte Nationale</option>\n                                        <option value=\"Permis de conduire\">Permis de conduire</option>\n                                        <option value=\"Passeport\">Passeport</option>\n                                        <option value=\"Autre\">Autre (Pr√©ciser)</option>\n                                    </select>\n\n                                    {/* Show text input if \"Autre\" is selected (value is not in standard list) */}\n                                    {!['CNI', 'Permis de conduire', 'Passeport'].includes(formData.id_card_type) && (\n                                        <input\n                                            type=\"text\"\n                                            name=\"id_card_type\"\n                                            value={formData.id_card_type}\n                                            onChange={handleChange}\n                                            placeholder=\"Pr√©cisez le type de document\"\n                                            className=\"w-full border border-gray-300 rounded-lg px-3 py-2 bg-gray-50 animate-in fade-in slide-in-from-top-1\"\n                                            required\n                                        />\n                                    )}\n                                </div>\n                            </div>\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 mb-1\">Num√©ro de pi√®ce</label>\n                                <input\n                                    name=\"id_card_number\"\n                                    value={formData.id_card_number || ''}\n                                    onChange={handleChange}\n                                    className=\"w-full border border-gray-300 rounded-lg px-3 py-2\"\n                                />\n                            </div>\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 mb-1\">Scan de la pi√®ce</label>\n                                <div className=\"flex gap-2 items-center\">\n                                    <input\n                                        type=\"file\"\n                                        accept=\".pdf,.jpg,.png\"\n                                        onChange={handleFileChange}\n                                        className=\"w-full text-sm text-gray-500 file:mr-2 file:py-1 file:px-2 file:rounded-full file:border-0 file:text-xs file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100\"\n                                    />\n                                    {formData.id_card_url && <span className=\"text-xs text-green-600 font-bold whitespace-nowrap\">Fichier re√ßu</span>}\n                                </div>\n                            </div>\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 mb-1\">Adresse de r√©sidence</label>\n                            <input\n                                name=\"address\"\n                                value={formData.address || ''}\n                                onChange={handleChange}\n                                className=\"w-full border border-gray-300 rounded-lg px-3 py-2\"\n                            />\n                        </div>\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 mb-1\">T√©l√©phone</label>\n                            <input\n                                name=\"phone\"\n                                value={formData.phone || ''}\n                                onChange={handleChange}\n                                className=\"w-full border border-gray-300 rounded-lg px-3 py-2\"\n                            />\n                        </div>\n                    </div>\n                </section>\n\n                {/* 2. INFORMATIONS PROFESSIONNELLES */}\n                <section className=\"bg-white p-6 rounded-2xl border border-gray-100 shadow-sm\">\n                    <div className=\"flex items-center gap-3 mb-6 border-b pb-4\">\n                        <div className=\"p-2 bg-amber-50 text-amber-600 rounded-lg\"><Briefcase className=\"w-5 h-5\" /></div>\n                        <h2 className=\"text-xl font-bold text-gray-800\">Parcours Professionnel</h2>\n                    </div>\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 mb-1\">Profession actuelle</label>\n                            <input\n                                name=\"profession\"\n                                value={formData.profession || ''}\n                                onChange={handleChange}\n                                className=\"w-full border border-gray-300 rounded-lg px-3 py-2\"\n                            />\n                        </div>\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 mb-1\">Statut</label>\n                            <select\n                                name=\"professional_status\"\n                                value={formData.professional_status || ''}\n                                onChange={handleChange}\n                                className=\"w-full border border-gray-300 rounded-lg px-3 py-2\"\n                            >\n                                <option value=\"\">Choisir...</option>\n                                <option value=\"Salari√©\">Salari√©</option>\n                                <option value=\"Ind√©pendant\">Ind√©pendant</option>\n                                <option value=\"√âtudiant\">√âtudiant</option>\n                                <option value=\"Sans emploi\">Sans emploi</option>\n                                <option value=\"Autre\">Autre</option>\n                            </select>\n                        </div>\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 mb-1\">Employeur / Institution</label>\n                            <input\n                                name=\"employer\"\n                                value={formData.employer || ''}\n                                onChange={handleChange}\n                                className=\"w-full border border-gray-300 rounded-lg px-3 py-2\"\n                            />\n                        </div>\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 mb-1\">Domaine d'activit√©</label>\n                            <input\n                                name=\"activity_field\"\n                                value={formData.activity_field || ''}\n                                onChange={handleChange}\n                                className=\"w-full border border-gray-300 rounded-lg px-3 py-2\"\n                            />\n                        </div>\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 mb-1\">Ann√©es d'exp√©rience</label>\n                            <input\n                                type=\"number\"\n                                name=\"experience_years\"\n                                value={formData.experience_years || ''}\n                                onChange={handleChange}\n                                className=\"w-full border border-gray-300 rounded-lg px-3 py-2\"\n                            />\n                        </div>\n                    </div>\n                </section>\n\n                {/* 3. INFORMATIONS ACAD√âMIQUES */}\n                <section className=\"bg-white p-6 rounded-2xl border border-gray-100 shadow-sm\">\n                    <div className=\"flex items-center gap-3 mb-6 border-b pb-4\">\n                        <div className=\"p-2 bg-purple-50 text-purple-600 rounded-lg\"><GraduationCap className=\"w-5 h-5\" /></div>\n                        <h2 className=\"text-xl font-bold text-gray-800\">Parcours Acad√©mique</h2>\n                    </div>\n\n                    <h3 className=\"font-bold text-gray-800 font-sm mb-4 uppercase text-xs tracking-wider\">√âtudes Universitaires</h3>\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6\">\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 mb-1\">Dernier dipl√¥me</label>\n                            <input\n                                name=\"last_degree\"\n                                value={formData.last_degree || ''}\n                                onChange={handleChange}\n                                className=\"w-full border border-gray-300 rounded-lg px-3 py-2\"\n                            />\n                        </div>\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 mb-1\">Sp√©cialit√©</label>\n                            <input\n                                name=\"specialty\"\n                                value={formData.specialty || ''}\n                                onChange={handleChange}\n                                className=\"w-full border border-gray-300 rounded-lg px-3 py-2\"\n                            />\n                        </div>\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 mb-1\">Universit√© / √âtablissement</label>\n                            <input\n                                name=\"university\"\n                                value={formData.university || ''}\n                                onChange={handleChange}\n                                className=\"w-full border border-gray-300 rounded-lg px-3 py-2\"\n                            />\n                        </div>\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 mb-1\">Ann√©e d'obtention</label>\n                            <input\n                                type=\"number\"\n                                name=\"degree_year\"\n                                value={formData.degree_year || ''}\n                                onChange={handleChange}\n                                className=\"w-full border border-gray-300 rounded-lg px-3 py-2\"\n                            />\n                        </div>\n                    </div>\n\n                    <h3 className=\"font-bold text-gray-800 font-sm mb-4 uppercase text-xs tracking-wider pt-4 border-t border-gray-50\">√âtudes Secondaires</h3>\n                    <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 mb-1\">Niveau atteint</label>\n                            <input\n                                name=\"high_school_level\"\n                                value={formData.high_school_level || ''}\n                                onChange={handleChange}\n                                className=\"w-full border border-gray-300 rounded-lg px-3 py-2\"\n                            />\n                        </div>\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 mb-1\">Lyc√©e fr√©quent√©</label>\n                            <input\n                                name=\"high_school_name\"\n                                value={formData.high_school_name || ''}\n                                onChange={handleChange}\n                                className=\"w-full border border-gray-300 rounded-lg px-3 py-2\"\n                            />\n                        </div>\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 mb-1\">Ann√©e du Bac</label>\n                            <input\n                                type=\"number\"\n                                name=\"bac_year\"\n                                value={formData.bac_year || ''}\n                                onChange={handleChange}\n                                className=\"w-full border border-gray-300 rounded-lg px-3 py-2\"\n                            />\n                        </div>\n                    </div>\n                </section>\n\n                {/* 4. EXP√âRIENCE LITT√âRAIRE */}\n                <section className=\"bg-white p-6 rounded-2xl border border-gray-100 shadow-sm\">\n                    <div className=\"flex items-center gap-3 mb-6 border-b pb-4\">\n                        <div className=\"p-2 bg-red-50 text-red-600 rounded-lg\"><Book className=\"w-5 h-5\" /></div>\n                        <h2 className=\"text-xl font-bold text-gray-800\">Exp√©rience Litt√©raire</h2>\n                    </div>\n\n                    <div className=\"space-y-4\">\n                        <div className=\"flex items-center gap-4\">\n                            <label className=\"block text-sm font-medium text-gray-700\">Avez-vous d√©j√† publi√© ?</label>\n                            <label className=\"inline-flex items-center cursor-pointer\">\n                                <input\n                                    type=\"checkbox\"\n                                    name=\"has_published\"\n                                    checked={formData.has_published}\n                                    onChange={handleChange}\n                                    className=\"sr-only peer\"\n                                />\n                                <div className=\"relative w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600\"></div>\n                            </label>\n                        </div>\n\n                    </div>\n\n                    {/* Enhanced Genres & Languages */}\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                        {/* Genres */}\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 mb-1\">Genres litt√©raires pratiqu√©s</label>\n                            <div className=\"space-y-2\">\n                                <div className=\"flex gap-2\">\n                                    <select\n                                        className=\"flex-1 border border-gray-300 rounded-lg px-3 py-2\"\n                                        value=\"\"\n                                        onChange={(e) => {\n                                            if (e.target.value === 'Autre') return; // Handled by UI toggle if needed, or just let user finish typing in 'Autre' input\n                                            if (e.target.value && !genres.includes(e.target.value)) {\n                                                setGenres([...genres, e.target.value]);\n                                            }\n                                        }}\n                                    >\n                                        <option value=\"\">Ajouter un genre...</option>\n                                        <option value=\"Roman\">Roman</option>\n                                        <option value=\"Po√©sie\">Po√©sie</option>\n                                        <option value=\"Nouvelle\">Nouvelle</option>\n                                        <option value=\"Essai\">Essai</option>\n                                        <option value=\"Th√©√¢tre\">Th√©√¢tre</option>\n                                        <option value=\"Jeunesse\">Jeunesse</option>\n                                    </select>\n                                    <input\n                                        placeholder=\"Autre...\"\n                                        className=\"w-1/3 border border-gray-300 rounded-lg px-3 py-2\"\n                                        value={genreInput}\n                                        onChange={e => setGenreInput(e.target.value)}\n                                        onKeyDown={e => {\n                                            if (e.key === 'Enter') {\n                                                e.preventDefault();\n                                                if (genreInput.trim()) {\n                                                    setGenres([...genres, genreInput.trim()]);\n                                                    setGenreInput('');\n                                                }\n                                            }\n                                        }}\n                                    />\n                                    <button\n                                        type=\"button\"\n                                        onClick={() => {\n                                            if (genreInput.trim()) {\n                                                setGenres([...genres, genreInput.trim()]);\n                                                setGenreInput('');\n                                            }\n                                        }}\n                                        className=\"bg-gray-100 px-3 rounded-lg hover:bg-gray-200\"\n                                    >\n                                        +\n                                    </button>\n                                </div>\n                                <div className=\"flex flex-wrap gap-2\">\n                                    {genres.map((g, idx) => (\n                                        <span key={idx} className=\"bg-blue-50 text-blue-700 px-2 py-1 rounded text-sm flex items-center gap-1\">\n                                            {g}\n                                            <button type=\"button\" onClick={() => setGenres(genres.filter((_, i) => i !== idx))} className=\"hover:text-blue-900\">√ó</button>\n                                        </span>\n                                    ))}\n                                </div>\n                            </div>\n                        </div>\n\n                        {/* Languages */}\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 mb-1\">Langue(s) d'√©criture</label>\n                            <div className=\"space-y-2\">\n                                <div className=\"flex gap-2\">\n                                    <select\n                                        className=\"flex-1 border border-gray-300 rounded-lg px-3 py-2\"\n                                        value=\"\"\n                                        onChange={(e) => {\n                                            if (e.target.value && !languages.includes(e.target.value)) {\n                                                setLanguages([...languages, e.target.value]);\n                                            }\n                                        }}\n                                    >\n                                        <option value=\"\">Ajouter une langue...</option>\n                                        <option value=\"Arabe\">Arabe</option>\n                                        <option value=\"Fran√ßais\">Fran√ßais</option>\n                                        <option value=\"Anglais\">Anglais</option>\n                                        <option value=\"Amazigh\">Amazigh</option>\n                                    </select>\n                                    <input\n                                        placeholder=\"Autre...\"\n                                        className=\"w-1/3 border border-gray-300 rounded-lg px-3 py-2\"\n                                        value={langInput}\n                                        onChange={e => setLangInput(e.target.value)}\n                                        onKeyDown={e => {\n                                            if (e.key === 'Enter') {\n                                                e.preventDefault();\n                                                if (langInput.trim()) {\n                                                    setLanguages([...languages, langInput.trim()]);\n                                                    setLangInput('');\n                                                }\n                                            }\n                                        }}\n                                    />\n                                    <button\n                                        type=\"button\"\n                                        onClick={() => {\n                                            if (langInput.trim()) {\n                                                setLanguages([...languages, langInput.trim()]);\n                                                setLangInput('');\n                                            }\n                                        }}\n                                        className=\"bg-gray-100 px-3 rounded-lg hover:bg-gray-200\"\n                                    >\n                                        +\n                                    </button>\n                                </div>\n                                <div className=\"flex flex-wrap gap-2\">\n                                    {languages.map((l, idx) => (\n                                        <span key={idx} className=\"bg-green-50 text-green-700 px-2 py-1 rounded text-sm flex items-center gap-1\">\n                                            {l}\n                                            <button type=\"button\" onClick={() => setLanguages(languages.filter((_, i) => i !== idx))} className=\"hover:text-green-900\">√ó</button>\n                                        </span>\n                                    ))}\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n\n                    {/* Enhanced Published Works List */}\n                    {formData.has_published && (\n                        <div className=\"animate-in fade-in slide-in-from-top-2 duration-300 pt-4 border-t border-gray-100\">\n                            <label className=\"block text-sm font-medium text-gray-700 mb-2\">Oeuvres Publi√©es</label>\n\n                            {/* List Builder */}\n                            <div className=\"bg-gray-50 p-4 rounded-lg mb-4 space-y-3\">\n                                <div className=\"grid grid-cols-1 md:grid-cols-3 gap-3\">\n                                    <input\n                                        placeholder=\"Titre de l'oeuvre\"\n                                        value={newBook.title}\n                                        onChange={e => setNewBook({ ...newBook, title: e.target.value })}\n                                        className=\"border border-gray-300 rounded px-2 py-1\"\n                                    />\n                                    <input\n                                        placeholder=\"Maison d'√©dition\"\n                                        value={newBook.publisher}\n                                        onChange={e => setNewBook({ ...newBook, publisher: e.target.value })}\n                                        className=\"border border-gray-300 rounded px-2 py-1\"\n                                    />\n                                    <div className=\"flex gap-2\">\n                                        <input\n                                            placeholder=\"Ann√©e\"\n                                            type=\"number\"\n                                            value={newBook.year}\n                                            onChange={e => setNewBook({ ...newBook, year: e.target.value })}\n                                            className=\"border border-gray-300 rounded px-2 py-1 flex-1\"\n                                        />\n                                        <button\n                                            type=\"button\"\n                                            disabled={!newBook.title}\n                                            onClick={() => {\n                                                if (newBook.title) {\n                                                    setBooks([...books, { ...newBook }]);\n                                                    setNewBook({ title: '', publisher: '', year: '' });\n                                                }\n                                            }}\n                                            className=\"bg-note-purple text-white px-3 py-1 rounded hover:bg-violet-700 disabled:opacity-50\"\n                                        >\n                                            Ajouter\n                                        </button>\n                                    </div>\n                                </div>\n                            </div>\n\n                            {/* Display List */}\n                            {books.length > 0 ? (\n                                <ul className=\"space-y-2\">\n                                    {books.map((book, idx) => (\n                                        <li key={idx} className=\"flex items-center justify-between bg-white border border-gray-100 p-2 rounded shadow-sm\">\n                                            <div className=\"text-sm\">\n                                                <span className=\"font-bold text-gray-800\">{book.title}</span>\n                                                {(book.year || book.publisher) && (\n                                                    <span className=\"text-gray-500\">\n                                                        {book.year && ` (${book.year})`}\n                                                        {book.publisher && ` - ${book.publisher}`}\n                                                    </span>\n                                                )}\n                                                {/* Fallback for raw legacy data */}\n                                                {!book.title && book.original && <span>{book.original}</span>}\n                                            </div>\n                                            <button\n                                                type=\"button\"\n                                                onClick={() => setBooks(books.filter((_, i) => i !== idx))}\n                                                className=\"text-red-500 hover:text-red-700 p-1\"\n                                                title=\"Supprimer\"\n                                            >\n                                                √ó\n                                            </button>\n                                        </li>\n                                    ))}\n                                </ul>\n                            ) : (\n                                <p className=\"text-sm text-gray-400 italic\">Aucune oeuvre ajout√©e pour le moment.</p>\n                            )}\n                        </div>\n                    )}\n\n                </section>\n\n                {/* 5. R√âSEAUX SOCIAUX */}\n                <section className=\"bg-white p-6 rounded-2xl border border-gray-100 shadow-sm\">\n                    <div className=\"flex items-center gap-3 mb-6 border-b pb-4\">\n                        <div className=\"p-2 bg-indigo-50 text-indigo-600 rounded-lg\"><Globe className=\"w-5 h-5\" /></div>\n                        <h2 className=\"text-xl font-bold text-gray-800\">Pr√©sence en Ligne</h2>\n                    </div>\n\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                        {['Facebook', 'Instagram', 'Twitter', 'LinkedIn', 'YouTube'].map(social => (\n                            <div key={social}>\n                                <label className=\"block text-sm font-medium text-gray-700 mb-1\">{social}</label>\n                                <input\n                                    name={`social_${social.toLowerCase()}`}\n                                    value={formData[`social_${social.toLowerCase()}`] || ''}\n                                    onChange={handleChange}\n                                    placeholder={`Lien ${social}`}\n                                    className=\"w-full border border-gray-300 rounded-lg px-3 py-2\"\n                                />\n                            </div>\n                        ))}\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 mb-1\">Site Web / Blog</label>\n                            <input\n                                name=\"website\"\n                                value={formData.website || ''}\n                                onChange={handleChange}\n                                placeholder=\"https://...\"\n                                className=\"w-full border border-gray-300 rounded-lg px-3 py-2\"\n                            />\n                        </div>\n                    </div>\n                </section>\n\n                <div className=\"flex justify-end pt-4 pb-12\">\n                    <button\n                        type=\"submit\"\n                        disabled={saving}\n                        className=\"bg-note-purple hover:bg-violet-700 text-white px-8 py-3 rounded-xl font-bold shadow-lg flex items-center gap-2\"\n                    >\n                        <Save className=\"w-5 h-5\" />\n                        {saving ? 'Enregistrement...' : 'Enregistrer mon Profil'}\n                    </button>\n                </div>\n\n            </form>\n        </div >\n    );\n};\n\nexport default ProfilePage;\n","usedDeprecatedRules":[]},{"filePath":"/Users/mac/Desktop/akouass/note/site de publising/site 1 /src/supabaseClient.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/mac/Desktop/akouass/note/site de publising/site 1 /vite.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]